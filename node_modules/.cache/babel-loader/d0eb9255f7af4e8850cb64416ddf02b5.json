{"ast":null,"code":"var _jsxFileName = \"/Users/vonojastro/Desktop/lms-frontend-v2/src/components/CheckoutPage/index.jsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport checkoutValidator from \"../../validators/checkout\";\nimport Header from \"../Header/index\";\nimport \"./index.css\";\nimport { Form, FormSpy, useField, useForm, useFormState } from \"react-final-form\";\nimport { SelectControl, InputControl } from \"components/common/Form/Inputs\";\nimport _ from \"lodash\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { api } from \"../../api\";\nimport { getProcessors } from \"api/payment\";\nimport useValidationSchema from \"hooks/use-validation-schema\";\nimport Avatar from \"../common/Avatar/index\";\nimport { getS3Url } from \"utils/teacherApplication\";\nimport { toast } from \"react-toastify\";\nimport { Country } from \"country-state-city\";\nimport { getStatesOfCountry } from \"country-state-city/dist/lib/state\";\nimport CITY from \"country-state-city/dist/lib/city\";\nimport SelectedPaymentMethod from \"./SelectedPaymentMethod\";\nimport { getPaymentMethodByProcId, toMoneyFormat } from \"utils/utils\";\nimport { CHECKOUT_PAGE_TOP_PAYMENT_METHODS, LEARNER_GRADE_LEVELS } from \"utils/constants\";\nimport TopPaymentMethod from \"./TopPaymentMethod/index\";\nimport OtherPaymentMethods from \"./OtherPaymentMethods\";\nimport { AnimatePresence, motion } from \"framer-motion\";\nimport PaymentMethodSelectorModal from \"./PaymentMethodSelectorModal/index\";\nimport { Error } from \"../common/Form/Inputs\";\nimport { Modal, Button } from \"react-bootstrap\";\nimport { PayPalScriptProvider, PayPalButtons, usePayPalScriptReducer } from \"@paypal/react-paypal-js\";\nimport { paypalConfig } from \"../../config/index\"; // import { paypalConfig } from \"config\";\n// const PayPalButton = window.paypal.Buttons.driver(\"react\", { React, ReactDOM });\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst CheckoutForm = _ref => {\n  _s();\n\n  let {\n    processors,\n    classes,\n    userType\n  } = _ref;\n  // const CURRENCY_SYMBOL = \"USD\";\n  // enrollees = null if user is solo learner, otherwise (user is family account) array of learners\n  const [currency, setCurrency] = useState(\"USD\");\n  const [paymentMode, setPaymentMode] = useState(-1);\n  const loading = useSelector(state => state.uiElements.getIn([\"loadingScreen\"]));\n  const [showModal, setShowModal] = useState(false);\n  const [loadingPayment, setLoadingPayment] = useState(false);\n  const [discountCode, setDiscountCode] = useState({\n    loading: false,\n    success: false,\n    error: false,\n    data: null\n  });\n  const {\n    change\n  } = useForm();\n  const {\n    submitFailed,\n    pristine,\n    hasValidationErrors,\n    dirtySinceLastSubmit,\n    values\n  } = useFormState();\n  const notValidated_discountCode = useField(\"notValidated_discountCode\");\n\n  const expandMode = index => {\n    if (index === paymentMode) {\n      setPaymentMode(-1);\n    } else {\n      setPaymentMode(index);\n    }\n  };\n\n  const handleClickPaymentMethod = method => {\n    change(\"procId\", method.procId);\n  };\n\n  const handleClickApplyDiscountCode = e => {\n    e.preventDefault();\n    const code = notValidated_discountCode.input.value; // Get not validated discount code\n\n    setDiscountCode(discountCode => ({ ...discountCode,\n      loading: true\n    }));\n    api.get(`discount/apply/${code}`).then(result => {\n      if (!result.data.discount.percentage) result.data.discount.percentage = 0; // Handles when \"percentage\" field of discount is null\n\n      setDiscountCode(discountCode => ({ ...discountCode,\n        error: false,\n        success: true,\n        data: result.data.discount\n      })); // if code is not valid update its value in react final form to null\n\n      change(\"discountCode\", result.data.discount.code);\n      toast.success(\"Discount Code Successfully Applied!\");\n    }).catch(err => {\n      toast.error(\"Invalid Discount Code\");\n      setDiscountCode(discountCode => ({ ...discountCode,\n        error: true,\n        success: false,\n        data: null\n      })); // otherwise set value to null\n\n      change(\"discountCode\", null);\n      change(\"notValidated_discountCode\", null);\n    }).finally(() => {\n      setDiscountCode(discountCode => ({ ...discountCode,\n        loading: false\n      }));\n    });\n  };\n\n  const handleClickRemoveDiscountCode = () => {\n    setDiscountCode(discountCode => ({ ...discountCode,\n      data: null\n    }));\n    change(\"discountCode\", null);\n  }; // const PRICE_MULTIPLIER = enrollees ? enrollees.length : 1;\n\n\n  const [subTotal, setSubTotal] = useState(0);\n  const [total, setTotal] = useState(0);\n  const [cashDiscount, setCashDiscount] = useState(0);\n  const userAuth = useSelector(state => state.auth);\n  let txnId = null;\n\n  const getEnrollees = enrollees => (userAuth.accountType === 'learner' ? [{ ...userAuth.user\n  }] : enrollees).map(_ref2 => {\n    let {\n      gradeLevel,\n      ...others\n    } = _ref2;\n    return { ...others,\n      gradeLevel: gradeLevel !== null && gradeLevel !== void 0 && gradeLevel.length ? LEARNER_GRADE_LEVELS.find(_ref3 => {\n        let {\n          value\n        } = _ref3;\n        return gradeLevel === value;\n      }).label : ''\n    };\n  });\n\n  const createOrder = async (data, actions) => {\n    // console.log('classParam', classParam, classes);\n    const orderId = await processPayment(values[\"procId\"]);\n    return orderId;\n  };\n\n  const onApprove = (data, actions) => {\n    return actions.order.capture().then(function (order, res) {\n      console.log('onApprove', order, order.purchase_units[0].payments.captures[0]);\n      const classParam = classes.map(_ref4 => {\n        let {\n          classId,\n          enrollees,\n          cartId\n        } = _ref4;\n        return {\n          classId,\n          enrollees: // If user is solo-learner, then he is an enrollee in enrollees array.\n          // Else, a family account, and the selected learners are the enrollees\n          getEnrollees(enrollees),\n          cartId\n        };\n      });\n      return api.post(`/payment/${userType}/paypal/checkout`, {\n        // discountCode: discountCode.data ? discountCode.data.code : undefined,\n        classes: classParam,\n        txnId,\n        // orderId: order.id,\n        captureId: order.purchase_units[0].payments.captures[0].id // capture: order.purchase_units[0].payments.captures[0],\n        // fee: order.purchase_units.payments.captures[0].seller_receivable_breakdown.paypal_fee.value\n\n      }).then(response => {\n        const redirectUrl = new URL(`${window.location.origin}/order-summary`);\n        redirectUrl.searchParams.append(\"txnid\", response.data.txnId);\n        redirectUrl.searchParams.append(\"refno\", order.orderId);\n        redirectUrl.searchParams.append(\"status\", \"S\");\n        redirectUrl.searchParams.append(\"message\", response.data.message);\n        redirectUrl.searchParams.append(\"param1\", response.data.param1);\n        redirectUrl.searchParams.append(\"currency\", currency);\n        redirectUrl.searchParams.append(\"subTotal\", subTotal);\n        redirectUrl.searchParams.append(\"cashDiscount\", cashDiscount);\n        redirectUrl.searchParams.append(\"total\", total);\n        window.location.replace(redirectUrl.href);\n        return response;\n      }).catch(error => {\n        toast.error(\"Failed to connect with payment. Please try again later.\");\n        console.log(error);\n      });\n    });\n  };\n\n  const processPayment = async procId => {\n    setLoadingPayment(true);\n    const classParam = classes.map(_ref5 => {\n      let {\n        classId,\n        enrollees,\n        cartId\n      } = _ref5;\n      return {\n        classId,\n        enrollees: // If user is solo-learner, then he is an enrollee in enrollees array.\n        // Else, a family account, and the selected learners are the enrollees\n        getEnrollees(enrollees),\n        cartId\n      };\n    });\n    return api.post(`/payment/${userType}/pay`, {\n      discountCode: discountCode.data ? discountCode.data.code : undefined,\n      classes: classParam,\n      procId\n    }).then(response => {\n      setLoadingPayment(false);\n      setShowModal(false);\n      txnId = response.data.txnId;\n\n      if (procId !== \"PYPL\") {\n        const redirectUrl = new URL(`${window.location.origin}/order-summary`);\n        redirectUrl.searchParams.append(\"txnid\", response.data.txnId);\n        redirectUrl.searchParams.append(\"refno\", null);\n        redirectUrl.searchParams.append(\"status\", \"P\");\n        redirectUrl.searchParams.append(\"message\", response.data.message);\n        redirectUrl.searchParams.append(\"param1\", response.data.param1);\n        redirectUrl.searchParams.append(\"currency\", currency);\n        redirectUrl.searchParams.append(\"subTotal\", subTotal);\n        redirectUrl.searchParams.append(\"cashDiscount\", cashDiscount);\n        redirectUrl.searchParams.append(\"total\", total);\n        window.location.replace(redirectUrl.href);\n        return response;\n      }\n\n      return response.data.id;\n    }).catch(err => {\n      var _err$response, _err$response$data, _err$response$data$er;\n\n      setLoadingPayment(false);\n      setShowModal(false);\n      toast.error((err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : (_err$response$data$er = _err$response$data.err) === null || _err$response$data$er === void 0 ? void 0 : _err$response$data$er.message) || 'Failed initiating payment. Please try again later.');\n    });\n  };\n\n  const onCancel = (data, actions) => {\n    api.post('/payment/void', {\n      orderId: data.orderID\n    });\n  };\n\n  const onError = (err, actions) => {\n    console.log('onErrorPayment', JSON.stringify(err));\n  };\n\n  useEffect(() => {\n    setCurrency(classes[0].currency);\n    let total = 0.0;\n    classes.forEach(item => {\n      const enrolleesCount = item.enrollees ? item.enrollees.length : 1;\n      total = total + parseFloat(item.price) * enrolleesCount;\n    });\n    setSubTotal(total);\n    setCashDiscount(() => {\n      if (discountCode.data) {\n        switch (discountCode.data.type) {\n          case \"percentage\":\n            return parseFloat(discountCode.data.percentage / 100) * parseFloat(subTotal);\n\n          case \"value\":\n            return parseFloat(discountCode.data.price);\n\n          default:\n            return 0;\n        }\n      } else {\n        return 0;\n      }\n    });\n    setTotal(() => {\n      if (discountCode.data) {\n        const discounted = subTotal - cashDiscount;\n\n        if (discounted < 0) {\n          change(\"procId\", \"none\");\n          return 0;\n        }\n\n        return discounted;\n      } else {\n        if (total === 0) {\n          change(\"procId\", \"none\");\n        }\n\n        return total;\n      }\n    });\n  }, [discountCode.data, subTotal, cashDiscount, classes, change]);\n\n  const handleClickOtherPaymentMethods = () => {};\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"checkout\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"left\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"checkout__order-details mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"custom-black-primary-text\",\n          children: \"Checkout\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"custom-black-secondary-text\",\n          children: \"Order Details\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 11\n        }, this), classes.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"checkout__order-details__detail justify-content-between mb-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"checkout__order-details__detail__image\",\n              style: {\n                backgroundImage: `url(${item.thumbnailImage ? item.thumbnailImage : \"../assets/images/image-placeholder.jpg\"})`\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 272,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"checkout__order-details__detail__description__title col ml-0\",\n              children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                className: \"mb-3\",\n                children: /*#__PURE__*/_jsxDEV(\"b\", {\n                  children: item.title\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 284,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 283,\n                columnNumber: 19\n              }, this), item.enrollees && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-2 mb-5\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    display: \"grid\",\n                    gridTemplateColumns: \"repeat(auto-fill, minmax(100px, 1fr))\",\n                    columnGap: 10,\n                    rowGap: 10\n                  },\n                  children: item.enrollees.map(enrollee => /*#__PURE__*/_jsxDEV(Avatar, {\n                    left: /*#__PURE__*/_jsxDEV(\"img\", {\n                      src: getS3Url(enrollee.photo),\n                      alt: enrollee.nickname,\n                      class: \"profile-pic mr-2\",\n                      height: 30,\n                      width: 30,\n                      style: {\n                        objectFit: \"cover\",\n                        objectPosition: \"center\"\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 300,\n                      columnNumber: 31\n                    }, this),\n                    right: /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"hide-menu font-14\",\n                      children: enrollee.nickname\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 310,\n                      columnNumber: 31\n                    }, this)\n                  }, enrollee.nickname, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 298,\n                    columnNumber: 27\n                  }, this))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 289,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 287,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 282,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"checkout__order-details__detail__description\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"checkout__order-details__detail__description__price col\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"checkout__order-details__detail__description__price--after-discount text-monospace\",\n                  children: [toMoneyFormat(item.price, currency), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-black-50\",\n                    children: [\"(\", item.enrollees ? item.enrollees.length : 1, \"x)\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 325,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 323,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 322,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 321,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 271,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 13\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 9\n      }, this), !discountCode.data && _.round(total, 2) > 0 &&\n      /*#__PURE__*/\n      // Show discountCode input only if none is applied\n      _jsxDEV(\"div\", {\n        className: \"discount-code d-flex align-items-center\",\n        children: [/*#__PURE__*/_jsxDEV(InputControl, {\n          name: \"notValidated_discountCode\",\n          label: \"\",\n          type: \"text\",\n          placeholder: \"Discount Code\",\n          disabled: discountCode.loading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 341,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn btn-outline-info w-auto ml-2 text-uppercase\",\n          onClick: handleClickApplyDiscountCode,\n          children: discountCode.loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"spinner-border text-primary mr-2\",\n              role: \"status\",\n              style: {\n                width: 20,\n                height: 20\n              },\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                class: \"sr-only\",\n                children: \"Loading...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 359,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 354,\n              columnNumber: 19\n            }, this), \"Validating\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 353,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: 118.76\n            },\n            children: \"Apply\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 364,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 340,\n        columnNumber: 11\n      }, this), discountCode.data && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"font-bold mb-3\",\n          children: \"Discount Code\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 372,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              border: \"1px solid\",\n              padding: 9,\n              borderRadius: 8,\n              fontSize: 17,\n              fontWeight: 700,\n              color: \"#1875d2\"\n            },\n            children: [discountCode.data.code, /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"ml-2 fa fa-times text-dark\",\n              style: {\n                opacity: 0.7,\n                cursor: \"pointer\"\n              },\n              onClick: handleClickRemoveDiscountCode\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 385,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 374,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 373,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 371,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"checkout__billing\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"checkout__billing__billing-address-input\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"font-bold\",\n            children: \"Billing Address\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 396,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: \"grid\",\n              rowGap: 30\n            },\n            children: [/*#__PURE__*/_jsxDEV(InputControl, {\n              type: \"text\",\n              name: \"streetAddress\",\n              label: \"Street Address\",\n              placeholder: \" \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 398,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(InputControl, {\n              type: \"text\",\n              name: \"streetAddress2\",\n              label: \"Street Address Line 2\",\n              placeholder: \" \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 404,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: \"grid\",\n                rowGap: 30\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: \"grid\",\n                  gridTemplateColumns: \"repeat(auto-fill, minmax(200px, 1fr))\",\n                  columnGap: 10\n                },\n                children: [/*#__PURE__*/_jsxDEV(FormSpy, {\n                  subscription: {\n                    values: true\n                  },\n                  children: props => // Solution for incomplete city data: allow user to input city manually\n                  props.values.country && props.values.state && (CITY.getCitiesOfState(props.values.country, props.values.state).length ? /*#__PURE__*/_jsxDEV(SelectControl, {\n                    label: \"City\",\n                    name: \"city\",\n                    options: CITY.getCitiesOfState(props.values.country, props.values.state).map(_ref6 => {\n                      let {\n                        name: label\n                      } = _ref6;\n                      return {\n                        label: `${label}`,\n                        value: label\n                      };\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 425,\n                    columnNumber: 27\n                  }, this) : /*#__PURE__*/_jsxDEV(InputControl, {\n                    type: \"text\",\n                    name: \"city\",\n                    label: \"City\",\n                    placeholder: \" \"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 437,\n                    columnNumber: 27\n                  }, this)) || /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 443,\n                    columnNumber: 32\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 418,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(FormSpy, {\n                  subscription: {\n                    values: true\n                  },\n                  children: props => /*#__PURE__*/_jsxDEV(SelectControl, {\n                    label: \"State\",\n                    name: \"state\",\n                    options: getStatesOfCountry(props.values.country).map(_ref7 => {\n                      let {\n                        name: label,\n                        isoCode: value,\n                        flag: emoji\n                      } = _ref7;\n                      return {\n                        label: `${label} ${emoji ? emoji : \"\"}`,\n                        value\n                      };\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 448,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 446,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 411,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: \"grid\",\n                  gridTemplateColumns: \"repeat(auto-fill, minmax(200px, 1fr))\",\n                  columnGap: 10\n                },\n                children: [/*#__PURE__*/_jsxDEV(InputControl, {\n                  type: \"text\",\n                  name: \"postalCode\",\n                  label: \"Postal Code\",\n                  placeholder: \" \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 468,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(SelectControl, {\n                  label: \"Country\",\n                  name: \"country\",\n                  options: Country.getAllCountries().map(_ref8 => {\n                    let {\n                      name: label,\n                      isoCode: value,\n                      flag: emoji\n                    } = _ref8;\n                    return {\n                      label: `${label} ${emoji ? emoji : \"\"}`,\n                      value\n                    };\n                  })\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 474,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 461,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 410,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 397,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-5\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"font-bold\",\n              children: \"Email Address\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 488,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(InputControl, {\n              type: \"text\",\n              name: \"email\",\n              label: \"\",\n              placeholder: \" \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 489,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 487,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 395,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 492,\n          columnNumber: 11\n        }, this), false && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"checkout__billing__payment-mode mt-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"font-bold\",\n            children: \"Payment Method\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 496,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center data-loading\",\n            style: {\n              display: loading ? \"block\" : \"none\",\n              width: \"38rem\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"spinner-border text-primary\",\n              role: \"status\",\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"sr-only\",\n                children: \"Loading...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 502,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 501,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"loading-text\",\n              children: \"Loading Payment Methods ...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 504,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 497,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center\",\n            style: {\n              display: !loading && Object.keys(processors).length < 1 ? \"block\" : \"none\",\n              width: \"38rem\"\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"no-data error\",\n              children: \"There was an error loading the Payment Methods. Please try refreshing the page.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 514,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 506,\n            columnNumber: 15\n          }, this), submitFailed && /*#__PURE__*/_jsxDEV(Error, {\n            name: \"procId\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 519,\n            columnNumber: 32\n          }, this), processors && /*#__PURE__*/_jsxDEV(FormSpy, {\n            subscription: {\n              values: true\n            },\n            children: props => /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                height: \"5rem\",\n                position: \"relative\"\n              },\n              children: /*#__PURE__*/_jsxDEV(AnimatePresence, {\n                exitBeforeEnter: true,\n                children: !props.values.procId && /*#__PURE__*/_jsxDEV(motion.div, {\n                  initial: {\n                    opacity: 0\n                  },\n                  animate: {\n                    opacity: 1\n                  } // transition={{ duration: 0.1 }}\n                  ,\n                  exit: {\n                    opacity: 0\n                  },\n                  style: {\n                    display: \"grid\",\n                    gridTemplateColumns: \"repeat(auto-fill, minmax(8rem, 1fr))\",\n                    gap: 10,\n                    width: \"100%\"\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(TopPaymentMethod, {\n                    paymentMethod: getPaymentMethodByProcId(CHECKOUT_PAGE_TOP_PAYMENT_METHODS[0], processors)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 544,\n                    columnNumber: 29\n                  }, this), /*#__PURE__*/_jsxDEV(TopPaymentMethod, {\n                    paymentMethod: getPaymentMethodByProcId(CHECKOUT_PAGE_TOP_PAYMENT_METHODS[1], processors)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 550,\n                    columnNumber: 29\n                  }, this), /*#__PURE__*/_jsxDEV(TopPaymentMethod, {\n                    paymentMethod: getPaymentMethodByProcId(CHECKOUT_PAGE_TOP_PAYMENT_METHODS[2], processors)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 556,\n                    columnNumber: 29\n                  }, this), /*#__PURE__*/_jsxDEV(PaymentMethodSelectorModal, {\n                    trigger: /*#__PURE__*/_jsxDEV(OtherPaymentMethods, {\n                      paymentMethod: {\n                        name: \"Other payment methods\",\n                        procId: \"others\",\n                        logo: \"img/ellipsis-logo.png\"\n                      },\n                      onClick: handleClickOtherPaymentMethods\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 564,\n                      columnNumber: 33\n                    }, this),\n                    subTotal: subTotal\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 562,\n                    columnNumber: 29\n                  }, this)]\n                }, \"toppaymentmethods-container\", true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 531,\n                  columnNumber: 27\n                }, this) || /*#__PURE__*/_jsxDEV(motion.div, {\n                  initial: {\n                    opacity: 0\n                  },\n                  animate: {\n                    opacity: 1\n                  },\n                  exit: {\n                    opacity: 0\n                  },\n                  style: {\n                    position: \"absolute\"\n                  },\n                  children: /*#__PURE__*/_jsxDEV(SelectedPaymentMethod, {\n                    method: getPaymentMethodByProcId(props.values.procId, processors),\n                    handleClickPaymentMethod: handleClickPaymentMethod\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 586,\n                    columnNumber: 29\n                  }, this)\n                }, \"selectedpaymentmethod\", false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 577,\n                  columnNumber: 27\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 529,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 523,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 521,\n            columnNumber: 17\n          }, this), false && !loading && Object.keys(processors).map((mode, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"accordion\",\n            id: \"accordionExample\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"card\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"card-header\",\n                id: `heading${index}`,\n                role: \"button\",\n                type: \"button\",\n                onClick: () => expandMode(index),\n                \"data-toggle\": \"collapse\",\n                \"data-target\": `#collapse${index}`,\n                \"aria-expanded\": \"false\",\n                \"aria-controls\": `collapse${index}`,\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"container\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"row justify-content-between\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      children: /*#__PURE__*/_jsxDEV(\"button\", {\n                        className: \"btn btn-link\",\n                        \"data-toggle\": \"collapse\",\n                        \"data-target\": `#collapse${index}`,\n                        \"aria-expanded\": \"false\",\n                        \"aria-controls\": `collapse${index}`,\n                        type: \"button\",\n                        children: mode\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 619,\n                        columnNumber: 31\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 618,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      children: [paymentMode !== index && /*#__PURE__*/_jsxDEV(\"button\", {\n                        className: \"btn btn-link\",\n                        \"data-toggle\": \"collapse\",\n                        \"data-target\": `#collapse${index}`,\n                        \"aria-expanded\": \"false\",\n                        \"aria-controls\": `collapse${index}`,\n                        type: \"button\",\n                        children: /*#__PURE__*/_jsxDEV(\"i\", {\n                          className: \"fas fa-chevron-right\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 640,\n                          columnNumber: 35\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 632,\n                        columnNumber: 33\n                      }, this), paymentMode === index && /*#__PURE__*/_jsxDEV(\"button\", {\n                        className: \"btn btn-link\",\n                        \"data-toggle\": \"collapse\",\n                        \"data-target\": `#collapse${index}`,\n                        \"aria-expanded\": \"false\",\n                        \"aria-controls\": `collapse${index}`,\n                        type: \"button\",\n                        children: /*#__PURE__*/_jsxDEV(\"i\", {\n                          className: \"fas fa-chevron-down\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 652,\n                          columnNumber: 35\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 644,\n                        columnNumber: 33\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 630,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 617,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 616,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 605,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                id: `collapse${index}`,\n                className: \"collapse\",\n                \"aria-labelledby\": `heading${index}`,\n                \"data-parent\": \"#accordionExample\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"card-body\",\n                  children: /*#__PURE__*/_jsxDEV(\"ul\", {\n                    class: \"list-group list-group-flush\",\n                    children: \"ww\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 667,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 666,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 660,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 604,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 603,\n            columnNumber: 19\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 495,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"right\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"checkout__summary\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"custom-black-secondary-text\",\n          children: \"Summary\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 679,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"checkout__summary__price\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: \"Subtotal:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 681,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-monospace\",\n            children: toMoneyFormat(subTotal, currency)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 682,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 680,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"checkout__summary__price\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: \"Coupon Discounts:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 685,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-monospace\",\n            children: cashDiscount > 0 ? \"-\" + toMoneyFormat(cashDiscount, currency) : \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 686,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 684,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n          className: \"border-dark\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 690,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"checkout__summary__price font-weight-bold\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: \"Total:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 692,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"font-20\",\n            children: toMoneyFormat(total, currency)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 693,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 691,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"font-14 mb-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Tagpros is required by law to collect applicable transaction taxes for purchases made in certain tax jurisdictions.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 696,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"By completing your purchase you agree to these\", \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-info font-bold\",\n              children: \"Terms of Service\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 702,\n              columnNumber: 15\n            }, this), \".\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 700,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 695,\n          columnNumber: 11\n        }, this), _.round(total, 2) === 0 && /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"py-2 w-100 text-white btn btn-info mt-4\",\n          type: \"submit\",\n          disabled: pristine || hasValidationErrors && !dirtySinceLastSubmit,\n          children: \"Proceed\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 705,\n          columnNumber: 39\n        }, this), _.round(total, 2) > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"btn btn-outline-info btn-block mb-3\",\n            \"data-toggle\": \"tooltip\",\n            title: \"Instructions will be given on deposit procedure\" // disabled={hasValidationErrors}\n            ,\n            onClick: () => {\n              setShowModal(true);\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fas fa-university mr-1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 721,\n              columnNumber: 15\n            }, this), \" \", /*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"Bank Transfer/Deposit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 721,\n              columnNumber: 58\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 713,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(PayPalScriptProvider, {\n            options: {\n              \"client-id\": paypalConfig.clientId,\n              components: \"buttons\",\n              currency: currency\n            },\n            children: /*#__PURE__*/_jsxDEV(ButtonWrapper, {\n              hasError: hasValidationErrors,\n              total: total,\n              discount: cashDiscount,\n              currency: currency,\n              showSpinner: false,\n              onCreateOrder: createOrder,\n              onApprove: onApprove,\n              onCancel: onCancel,\n              onError: onError\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 729,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 723,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 712,\n          columnNumber: 37\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 678,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 677,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      size: \"lg\",\n      show: showModal,\n      backdrop: \"static\",\n      keyboard: false,\n      children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n        children: /*#__PURE__*/_jsxDEV(Modal.Title, {\n          children: \"Bank Transfer/Deposit Details\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 751,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 750,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {\n        className: \"bank-details\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Clicking proceed will add class/es included in this checkout to your \", /*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"Pending Enrollments\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 754,\n            columnNumber: 83\n          }, this), \". Enrollment will be considered final once we confirm receipt of the payment. You will receive an invoice with complete payment instructions in your tagpros registered email address.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 754,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Please take note of the bank details below.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 758,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n          class: \"table table-bordered table-striped\",\n          children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: [/*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"text-uppercase\",\n                children: /*#__PURE__*/_jsxDEV(\"b\", {\n                  children: \"Bank Name: \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 762,\n                  columnNumber: 48\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 762,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: \"Bank of the Philippine Islands \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 763,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 761,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"text-uppercase\",\n                children: /*#__PURE__*/_jsxDEV(\"b\", {\n                  children: \"Account Name: \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 766,\n                  columnNumber: 48\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 766,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: \"Tagpros Education OPC\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 767,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 765,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"text-uppercase\",\n                children: /*#__PURE__*/_jsxDEV(\"b\", {\n                  children: \"Account Number\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 770,\n                  columnNumber: 48\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 770,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 771,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 769,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"pl-5\",\n                children: /*#__PURE__*/_jsxDEV(\"b\", {\n                  children: \"Dollar Account: \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 774,\n                  columnNumber: 38\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 774,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: \"002024-5256-89\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 775,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 773,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"pl-5\",\n                children: /*#__PURE__*/_jsxDEV(\"b\", {\n                  children: \"Peso Account: \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 778,\n                  columnNumber: 38\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 778,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: \"002021-5053-26\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 779,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 777,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 760,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 759,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: /*#__PURE__*/_jsxDEV(\"i\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 784,\n            columnNumber: 14\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 784,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 753,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Modal.Footer, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          variant: \"primary\",\n          onClick: () => processPayment(\"OTC\"),\n          disabled: loadingPayment,\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              display: loadingPayment ? 'inline-block' : 'none'\n            },\n            class: \"spinner-border spinner-border-sm btn-load\",\n            role: \"status\",\n            \"aria-hidden\": \"true\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 788,\n            columnNumber: 13\n          }, this), \"Proceed\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 787,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"secondary\",\n          onClick: () => setShowModal(false),\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 796,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 786,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 744,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 264,\n    columnNumber: 5\n  }, this);\n};\n\n_s(CheckoutForm, \"peoksVtJH2SIxMT0ZSXmDT0O4RQ=\", false, function () {\n  return [useSelector, useForm, useFormState, useField, useSelector];\n});\n\n_c = CheckoutForm;\n\nconst ButtonWrapper = _ref9 => {\n  _s2();\n\n  let {\n    total,\n    cashDiscount,\n    currency,\n    showSpinner,\n    hasError,\n    onCreateOrder,\n    onApprove,\n    onCancel,\n    onError\n  } = _ref9;\n  // usePayPalScriptReducer can be use only inside children of PayPalScriptProviders\n  // This is the main reason to wrap the PayPalButtons in a new component\n  const [{\n    options,\n    isPending\n  }, dispatch] = usePayPalScriptReducer();\n  useEffect(() => {\n    dispatch({\n      type: \"resetOptions\",\n      value: { ...options,\n        currency: currency\n      }\n    }); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [currency, showSpinner]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [showSpinner && isPending && /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"spinner-border spinner-border-sm btn-load\",\n      role: \"status\",\n      \"aria-hidden\": \"true\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 823,\n      columnNumber: 45\n    }, this), /*#__PURE__*/_jsxDEV(PayPalButtons, {\n      style: {\n        color: 'blue',\n        label: 'buynow'\n      },\n      disabled: hasError,\n      forceReRender: [total, currency, cashDiscount],\n      fundingSource: undefined,\n      disableFunding: \"credit\",\n      createOrder: (data, actions) => onCreateOrder(data, actions),\n      onApprove: (data, actions) => onApprove(data, actions),\n      onCancel: (data, actions) => onCancel(data, actions),\n      onError: (data, actions) => onError(data, actions)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 824,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n};\n\n_s2(ButtonWrapper, \"97F4ge0M9DD6AP5/rccpuT1ImVM=\", false, function () {\n  return [usePayPalScriptReducer];\n});\n\n_c2 = ButtonWrapper;\nexport default function CheckoutPage() {\n  _s3();\n\n  var _location$state, _location$state2, _location$state3, _location$state4;\n\n  // const [classDetails, setclassDetails] = useState({});\n  const navigate = useNavigate();\n  const location = useLocation();\n  const dispatch = useDispatch();\n  const processors = useSelector(state => state.payment ? state.payment.getIn([\"data\", \"processors\"]) : []); // const { enrollmentId } = useSelector((state) =>\n  //   state.classes.get(\"enroll\") ? state.classes.get(\"enroll\") : {}\n  // );\n\n  const user = useSelector(state => state.auth.user ? state.auth.user : {});\n  const userAuth = useSelector(state => state.auth);\n  const searchParams = {\n    learners: (_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.learners,\n    classId: (_location$state2 = location.state) === null || _location$state2 === void 0 ? void 0 : _location$state2.classId,\n    enrollmentId: (_location$state3 = location.state) === null || _location$state3 === void 0 ? void 0 : _location$state3.enrollmentId,\n    classes: (_location$state4 = location.state) === null || _location$state4 === void 0 ? void 0 : _location$state4.classes\n  };\n\n  const fetchData = async () => {\n    getProcessors(dispatch);\n  };\n\n  const getEnrollees = enrollees => userAuth.accountType === 'learner' ? [{ ...userAuth.user\n  }] : enrollees;\n\n  const submit = values => {\n    // const redirectUrl =\n    //   \"/order-summary?txnid=txn00011&refno=PLB697I1&status=S&message=%5b000%5d+BOG+Reference+No%3a+20211102181838+%23PLB697I1&digest=855d20e8a8e422b6878b3352af5fd61b07ed3c6f\";\n    const classParam = searchParams.classes.map(_ref10 => {\n      let {\n        classId,\n        enrollees,\n        cartId\n      } = _ref10;\n      return {\n        classId,\n        enrollees: getEnrollees(enrollees),\n        cartId\n      };\n    });\n    api.post(`/payment/${user.type}`, { ...values,\n      classes: classParam\n    }).then(response => {\n      if (response.data.free === true) {\n        const redirectUrl = new URL(`${window.location.origin}/order-summary`);\n        redirectUrl.searchParams.append(\"txnid\", response.data.txnId);\n        redirectUrl.searchParams.append(\"refno\", response.data.txnId);\n        redirectUrl.searchParams.append(\"status\", \"S\");\n        redirectUrl.searchParams.append(\"message\", \"Free Enrollment\");\n        redirectUrl.searchParams.append(\"param1\", response.data.param1);\n        window.location.replace(redirectUrl.href);\n      } else {\n        window.location.replace(response.data.Url);\n      }\n    }).catch(error => {\n      toast.error(\"Failed to connect with payment. Please try again later.\");\n      console.log(error);\n    }); // navigate(redirectUrl);\n  }; // const isInvalidVisit = () =>\n  //   (user.type === \"family\" && searchParams[\"classes\"]) ||\n  //   (user.type === \"learner\" && searchParams[\"classes\"]);\n\n\n  useEffect(() => {\n    if (!user || !searchParams[\"classes\"]) navigate(\"/\", {\n      replace: true\n    });\n    fetchData(); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  const validate = useValidationSchema(checkoutValidator);\n  return /*#__PURE__*/_jsxDEV(Form, {\n    onSubmit: submit,\n    validate: validate,\n    initialValues: {\n      procId: \"PYPL\",\n      email: user === null || user === void 0 ? void 0 : user.email,\n      country: \"PH\",\n      state: \"ABR\",\n      city: \"Adams\"\n    },\n    render: _ref11 => {\n      let {\n        handleSubmit\n      } = _ref11;\n      return /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"wrapper radio-input-fix\",\n        onSubmit: handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"header\",\n          children: /*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 921,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 920,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"content\",\n          children: /*#__PURE__*/_jsxDEV(CheckoutForm, {\n            processors: processors,\n            enrollees: searchParams.learners,\n            classes: searchParams.classes,\n            userType: user.type\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 925,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 923,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 919,\n        columnNumber: 9\n      }, this);\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 908,\n    columnNumber: 5\n  }, this);\n}\n\n_s3(CheckoutPage, \"/hQsAUWZXGk1z9YCMed1oqtjVvo=\", false, function () {\n  return [useNavigate, useLocation, useDispatch, useSelector, useSelector, useSelector, useValidationSchema];\n});\n\n_c3 = CheckoutPage;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"CheckoutForm\");\n$RefreshReg$(_c2, \"ButtonWrapper\");\n$RefreshReg$(_c3, \"CheckoutPage\");","map":{"version":3,"sources":["/Users/vonojastro/Desktop/lms-frontend-v2/src/components/CheckoutPage/index.jsx"],"names":["React","useEffect","useState","checkoutValidator","Header","Form","FormSpy","useField","useForm","useFormState","SelectControl","InputControl","_","useLocation","useNavigate","useSelector","useDispatch","api","getProcessors","useValidationSchema","Avatar","getS3Url","toast","Country","getStatesOfCountry","CITY","SelectedPaymentMethod","getPaymentMethodByProcId","toMoneyFormat","CHECKOUT_PAGE_TOP_PAYMENT_METHODS","LEARNER_GRADE_LEVELS","TopPaymentMethod","OtherPaymentMethods","AnimatePresence","motion","PaymentMethodSelectorModal","Error","Modal","Button","PayPalScriptProvider","PayPalButtons","usePayPalScriptReducer","paypalConfig","CheckoutForm","processors","classes","userType","currency","setCurrency","paymentMode","setPaymentMode","loading","state","uiElements","getIn","showModal","setShowModal","loadingPayment","setLoadingPayment","discountCode","setDiscountCode","success","error","data","change","submitFailed","pristine","hasValidationErrors","dirtySinceLastSubmit","values","notValidated_discountCode","expandMode","index","handleClickPaymentMethod","method","procId","handleClickApplyDiscountCode","e","preventDefault","code","input","value","get","then","result","discount","percentage","catch","err","finally","handleClickRemoveDiscountCode","subTotal","setSubTotal","total","setTotal","cashDiscount","setCashDiscount","userAuth","auth","txnId","getEnrollees","enrollees","accountType","user","map","gradeLevel","others","length","find","label","createOrder","actions","orderId","processPayment","onApprove","order","capture","res","console","log","purchase_units","payments","captures","classParam","classId","cartId","post","captureId","id","response","redirectUrl","URL","window","location","origin","searchParams","append","message","param1","replace","href","undefined","onCancel","orderID","onError","JSON","stringify","forEach","item","enrolleesCount","parseFloat","price","type","discounted","handleClickOtherPaymentMethods","backgroundImage","thumbnailImage","title","display","gridTemplateColumns","columnGap","rowGap","enrollee","photo","nickname","objectFit","objectPosition","round","width","height","border","padding","borderRadius","fontSize","fontWeight","color","opacity","cursor","props","country","getCitiesOfState","name","isoCode","flag","emoji","getAllCountries","Object","keys","position","gap","logo","mode","clientId","components","ButtonWrapper","showSpinner","hasError","onCreateOrder","options","isPending","dispatch","CheckoutPage","navigate","payment","learners","enrollmentId","fetchData","submit","free","Url","validate","email","city","handleSubmit"],"mappings":";;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,OAAOC,iBAAP,MAA8B,2BAA9B;AACA,OAAOC,MAAP,MAAmB,iBAAnB;AACA,OAAO,aAAP;AACA,SAASC,IAAT,EAAeC,OAAf,EAAwBC,QAAxB,EAAkCC,OAAlC,EAA2CC,YAA3C,QAA+D,kBAA/D;AACA,SAASC,aAAT,EAAwBC,YAAxB,QAA4C,+BAA5C;AACA,OAAOC,CAAP,MAAc,QAAd;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,kBAAzC;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,SAASC,GAAT,QAAoB,WAApB;AACA,SAASC,aAAT,QAA8B,aAA9B;AACA,OAAOC,mBAAP,MAAgC,6BAAhC;AACA,OAAOC,MAAP,MAAmB,wBAAnB;AACA,SAASC,QAAT,QAAyB,0BAAzB;AACA,SAASC,KAAT,QAAsB,gBAAtB;AACA,SAASC,OAAT,QAAwB,oBAAxB;AACA,SAASC,kBAAT,QAAmC,mCAAnC;AACA,OAAOC,IAAP,MAAiB,kCAAjB;AACA,OAAOC,qBAAP,MAAkC,yBAAlC;AACA,SAASC,wBAAT,EAAmCC,aAAnC,QAAwD,aAAxD;AACA,SAASC,iCAAT,EAA4CC,oBAA5C,QAAwE,iBAAxE;AACA,OAAOC,gBAAP,MAA6B,0BAA7B;AACA,OAAOC,mBAAP,MAAgC,uBAAhC;AACA,SAASC,eAAT,EAA0BC,MAA1B,QAAwC,eAAxC;AACA,OAAOC,0BAAP,MAAuC,oCAAvC;AACA,SAASC,KAAT,QAAsB,uBAAtB;AACA,SAASC,KAAT,EAAgBC,MAAhB,QAA8B,iBAA9B;AACA,SACEC,oBADF,EAEEC,aAFF,EAGEC,sBAHF,QAIO,yBAJP;AAKA,SAASC,YAAT,QAA6B,oBAA7B,C,CACA;AAEA;;;;;AAEA,MAAMC,YAAY,GAAG,QAAuC;AAAA;;AAAA,MAAtC;AAAEC,IAAAA,UAAF;AAAcC,IAAAA,OAAd;AAAuBC,IAAAA;AAAvB,GAAsC;AAC1D;AACA;AACA,QAAM,CAACC,QAAD,EAAWC,WAAX,IAA0B9C,QAAQ,CAAC,KAAD,CAAxC;AACA,QAAM,CAAC+C,WAAD,EAAcC,cAAd,IAAgChD,QAAQ,CAAC,CAAC,CAAF,CAA9C;AACA,QAAMiD,OAAO,GAAGpC,WAAW,CAAEqC,KAAD,IAAWA,KAAK,CAACC,UAAN,CAAiBC,KAAjB,CAAuB,CAAC,eAAD,CAAvB,CAAZ,CAA3B;AACA,QAAM,CAACC,SAAD,EAAYC,YAAZ,IAA4BtD,QAAQ,CAAC,KAAD,CAA1C;AACA,QAAM,CAACuD,cAAD,EAAiBC,iBAAjB,IAAsCxD,QAAQ,CAAC,KAAD,CAApD;AACA,QAAM,CAACyD,YAAD,EAAeC,eAAf,IAAkC1D,QAAQ,CAAC;AAC/CiD,IAAAA,OAAO,EAAE,KADsC;AAE/CU,IAAAA,OAAO,EAAE,KAFsC;AAG/CC,IAAAA,KAAK,EAAE,KAHwC;AAI/CC,IAAAA,IAAI,EAAE;AAJyC,GAAD,CAAhD;AAMA,QAAM;AAAEC,IAAAA;AAAF,MAAaxD,OAAO,EAA1B;AACA,QAAM;AAAEyD,IAAAA,YAAF;AAAgBC,IAAAA,QAAhB;AAA0BC,IAAAA,mBAA1B;AAA+CC,IAAAA,oBAA/C;AAAqEC,IAAAA;AAArE,MAAgF5D,YAAY,EAAlG;AACA,QAAM6D,yBAAyB,GAAG/D,QAAQ,CAAC,2BAAD,CAA1C;;AAEA,QAAMgE,UAAU,GAAIC,KAAD,IAAW;AAC5B,QAAIA,KAAK,KAAKvB,WAAd,EAA2B;AACzBC,MAAAA,cAAc,CAAC,CAAC,CAAF,CAAd;AACD,KAFD,MAEO;AACLA,MAAAA,cAAc,CAACsB,KAAD,CAAd;AACD;AACF,GAND;;AAQA,QAAMC,wBAAwB,GAAIC,MAAD,IAAY;AAC3CV,IAAAA,MAAM,CAAC,QAAD,EAAWU,MAAM,CAACC,MAAlB,CAAN;AACD,GAFD;;AAIA,QAAMC,4BAA4B,GAAIC,CAAD,IAAO;AAC1CA,IAAAA,CAAC,CAACC,cAAF;AACA,UAAMC,IAAI,GAAGT,yBAAyB,CAACU,KAA1B,CAAgCC,KAA7C,CAF0C,CAEU;;AAEpDrB,IAAAA,eAAe,CAAED,YAAD,KAAmB,EAAE,GAAGA,YAAL;AAAmBR,MAAAA,OAAO,EAAE;AAA5B,KAAnB,CAAD,CAAf;AACAlC,IAAAA,GAAG,CACAiE,GADH,CACQ,kBAAiBH,IAAK,EAD9B,EAEGI,IAFH,CAESC,MAAD,IAAY;AAChB,UAAI,CAACA,MAAM,CAACrB,IAAP,CAAYsB,QAAZ,CAAqBC,UAA1B,EAAsCF,MAAM,CAACrB,IAAP,CAAYsB,QAAZ,CAAqBC,UAArB,GAAkC,CAAlC,CADtB,CAC2D;;AAC3E1B,MAAAA,eAAe,CAAED,YAAD,KAAmB,EACjC,GAAGA,YAD8B;AAEjCG,QAAAA,KAAK,EAAE,KAF0B;AAGjCD,QAAAA,OAAO,EAAE,IAHwB;AAIjCE,QAAAA,IAAI,EAAEqB,MAAM,CAACrB,IAAP,CAAYsB;AAJe,OAAnB,CAAD,CAAf,CAFgB,CAQhB;;AACArB,MAAAA,MAAM,CAAC,cAAD,EAAiBoB,MAAM,CAACrB,IAAP,CAAYsB,QAAZ,CAAqBN,IAAtC,CAAN;AACAzD,MAAAA,KAAK,CAACuC,OAAN,CAAc,qCAAd;AACD,KAbH,EAcG0B,KAdH,CAcUC,GAAD,IAAS;AACdlE,MAAAA,KAAK,CAACwC,KAAN,CAAY,uBAAZ;AACAF,MAAAA,eAAe,CAAED,YAAD,KAAmB,EACjC,GAAGA,YAD8B;AAEjCG,QAAAA,KAAK,EAAE,IAF0B;AAGjCD,QAAAA,OAAO,EAAE,KAHwB;AAIjCE,QAAAA,IAAI,EAAE;AAJ2B,OAAnB,CAAD,CAAf,CAFc,CAQd;;AACAC,MAAAA,MAAM,CAAC,cAAD,EAAiB,IAAjB,CAAN;AACAA,MAAAA,MAAM,CAAC,2BAAD,EAA8B,IAA9B,CAAN;AACD,KAzBH,EA0BGyB,OA1BH,CA0BW,MAAM;AACb7B,MAAAA,eAAe,CAAED,YAAD,KAAmB,EAAE,GAAGA,YAAL;AAAmBR,QAAAA,OAAO,EAAE;AAA5B,OAAnB,CAAD,CAAf;AACD,KA5BH;AA6BD,GAlCD;;AAmCA,QAAMuC,6BAA6B,GAAG,MAAM;AAC1C9B,IAAAA,eAAe,CAAED,YAAD,KAAmB,EAAE,GAAGA,YAAL;AAAmBI,MAAAA,IAAI,EAAE;AAAzB,KAAnB,CAAD,CAAf;AACAC,IAAAA,MAAM,CAAC,cAAD,EAAiB,IAAjB,CAAN;AACD,GAHD,CAjE0D,CAsE1D;;;AACA,QAAM,CAAC2B,QAAD,EAAWC,WAAX,IAA0B1F,QAAQ,CAAC,CAAD,CAAxC;AACA,QAAM,CAAC2F,KAAD,EAAQC,QAAR,IAAoB5F,QAAQ,CAAC,CAAD,CAAlC;AACA,QAAM,CAAC6F,YAAD,EAAeC,eAAf,IAAkC9F,QAAQ,CAAC,CAAD,CAAhD;AACA,QAAM+F,QAAQ,GAAGlF,WAAW,CAACqC,KAAK,IAAIA,KAAK,CAAC8C,IAAhB,CAA5B;AACA,MAAIC,KAAK,GAAG,IAAZ;;AAEA,QAAMC,YAAY,GAAIC,SAAD,IACnB,CAACJ,QAAQ,CAACK,WAAT,KAAyB,SAAzB,GAAqC,CAAC,EAAE,GAAGL,QAAQ,CAACM;AAAd,GAAD,CAArC,GAA8DF,SAA/D,EAA2EG,GAA3E,CAA+E;AAAA,QAAC;AAACC,MAAAA,UAAD;AAAa,SAAGC;AAAhB,KAAD;AAAA,WAA4B,EAAC,GAAGA,MAAJ;AAAYD,MAAAA,UAAU,EAAEA,UAAU,SAAV,IAAAA,UAAU,WAAV,IAAAA,UAAU,CAAEE,MAAZ,GAAqB7E,oBAAoB,CAAC8E,IAArB,CAA0B;AAAA,YAAC;AAAC3B,UAAAA;AAAD,SAAD;AAAA,eAAYwB,UAAU,KAAKxB,KAA3B;AAAA,OAA1B,EAA4D4B,KAAjF,GAAuF;AAA/G,KAA5B;AAAA,GAA/E,CADF;;AAGA,QAAMC,WAAW,GAAG,OAAO/C,IAAP,EAAagD,OAAb,KAAyB;AAC3C;AACA,UAAMC,OAAO,GAAG,MAAMC,cAAc,CAAC5C,MAAM,CAAC,QAAD,CAAP,CAApC;AAEA,WAAO2C,OAAP;AACD,GALD;;AAOA,QAAME,SAAS,GAAG,CAACnD,IAAD,EAAOgD,OAAP,KAAmB;AACnC,WAAOA,OAAO,CAACI,KAAR,CAAcC,OAAd,GAAwBjC,IAAxB,CAA6B,UAAUgC,KAAV,EAAiBE,GAAjB,EAAsB;AACxDC,MAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBJ,KAAzB,EAAgCA,KAAK,CAACK,cAAN,CAAqB,CAArB,EAAwBC,QAAxB,CAAiCC,QAAjC,CAA0C,CAA1C,CAAhC;AACA,YAAMC,UAAU,GAAG9E,OAAO,CAAC2D,GAAR,CAAY,SAAkC;AAAA,YAAjC;AAACoB,UAAAA,OAAD;AAAUvB,UAAAA,SAAV;AAAqBwB,UAAAA;AAArB,SAAiC;AAC/D,eAAO;AAACD,UAAAA,OAAD;AACLvB,UAAAA,SAAS,EACT;AACA;AACAD,UAAAA,YAAY,CAACC,SAAD,CAJP;AAKLwB,UAAAA;AALK,SAAP;AAMD,OAPkB,CAAnB;AAQA,aAAO5G,GAAG,CACT6G,IADM,CACA,YAAWhF,QAAS,kBADpB,EACuC;AAC5C;AACAD,QAAAA,OAAO,EAAE8E,UAFmC;AAG5CxB,QAAAA,KAH4C;AAI5C;AACA4B,QAAAA,SAAS,EAAEZ,KAAK,CAACK,cAAN,CAAqB,CAArB,EAAwBC,QAAxB,CAAiCC,QAAjC,CAA0C,CAA1C,EAA6CM,EALZ,CAM5C;AACA;;AAP4C,OADvC,EAUN7C,IAVM,CAUA8C,QAAD,IAAc;AAClB,cAAMC,WAAW,GAAG,IAAIC,GAAJ,CAAS,GAAEC,MAAM,CAACC,QAAP,CAAgBC,MAAO,gBAAlC,CAApB;AACEJ,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,OAAhC,EAAyCP,QAAQ,CAAClE,IAAT,CAAcoC,KAAvD;AACA+B,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,OAAhC,EAAyCrB,KAAK,CAACH,OAA/C;AACAkB,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,QAAhC,EAA0C,GAA1C;AACAN,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,SAAhC,EAA2CP,QAAQ,CAAClE,IAAT,CAAc0E,OAAzD;AACAP,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,QAAhC,EAA0CP,QAAQ,CAAClE,IAAT,CAAc2E,MAAxD;AACAR,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,UAAhC,EAA4CzF,QAA5C;AACAmF,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,UAAhC,EAA4C7C,QAA5C;AACAuC,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,cAAhC,EAAgDzC,YAAhD;AACAmC,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,OAAhC,EAAyC3C,KAAzC;AACAuC,QAAAA,MAAM,CAACC,QAAP,CAAgBM,OAAhB,CAAwBT,WAAW,CAACU,IAApC;AACA,eAAOX,QAAP;AACH,OAvBM,EAwBN1C,KAxBM,CAwBCzB,KAAD,IAAW;AAChBxC,QAAAA,KAAK,CAACwC,KAAN,CAAY,yDAAZ;AACAwD,QAAAA,OAAO,CAACC,GAAR,CAAYzD,KAAZ;AACD,OA3BM,CAAP;AA4BD,KAtCM,CAAP;AAuCD,GAxCD;;AA0CA,QAAMmD,cAAc,GAAG,MAAOtC,MAAP,IAAkB;AACvCjB,IAAAA,iBAAiB,CAAC,IAAD,CAAjB;AACA,UAAMiE,UAAU,GAAG9E,OAAO,CAAC2D,GAAR,CAAY,SAAoC;AAAA,UAAnC;AAAEoB,QAAAA,OAAF;AAAWvB,QAAAA,SAAX;AAAsBwB,QAAAA;AAAtB,OAAmC;AACjE,aAAO;AACLD,QAAAA,OADK;AAELvB,QAAAA,SAAS,EACP;AACA;AACAD,QAAAA,YAAY,CAACC,SAAD,CALT;AAMLwB,QAAAA;AANK,OAAP;AAQD,KATkB,CAAnB;AAWA,WAAO5G,GAAG,CACP6G,IADI,CACE,YAAWhF,QAAS,MADtB,EAC6B;AAChCa,MAAAA,YAAY,EAAEA,YAAY,CAACI,IAAb,GAAoBJ,YAAY,CAACI,IAAb,CAAkBgB,IAAtC,GAA6C8D,SAD3B;AAEhChG,MAAAA,OAAO,EAAE8E,UAFuB;AAGhChD,MAAAA;AAHgC,KAD7B,EAMJQ,IANI,CAME8C,QAAD,IAAc;AAClBvE,MAAAA,iBAAiB,CAAC,KAAD,CAAjB;AACAF,MAAAA,YAAY,CAAC,KAAD,CAAZ;AACA2C,MAAAA,KAAK,GAAG8B,QAAQ,CAAClE,IAAT,CAAcoC,KAAtB;;AACA,UAAGxB,MAAM,KAAK,MAAd,EAAqB;AACnB,cAAMuD,WAAW,GAAG,IAAIC,GAAJ,CAAS,GAAEC,MAAM,CAACC,QAAP,CAAgBC,MAAO,gBAAlC,CAApB;AACAJ,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,OAAhC,EAAyCP,QAAQ,CAAClE,IAAT,CAAcoC,KAAvD;AACA+B,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,OAAhC,EAAyC,IAAzC;AACAN,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,QAAhC,EAA0C,GAA1C;AACAN,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,SAAhC,EAA2CP,QAAQ,CAAClE,IAAT,CAAc0E,OAAzD;AACAP,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,QAAhC,EAA0CP,QAAQ,CAAClE,IAAT,CAAc2E,MAAxD;AACAR,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,UAAhC,EAA4CzF,QAA5C;AACAmF,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,UAAhC,EAA4C7C,QAA5C;AACAuC,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,cAAhC,EAAgDzC,YAAhD;AACAmC,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,OAAhC,EAAyC3C,KAAzC;AACAuC,QAAAA,MAAM,CAACC,QAAP,CAAgBM,OAAhB,CAAwBT,WAAW,CAACU,IAApC;AACA,eAAOX,QAAP;AACD;;AACD,aAAOA,QAAQ,CAAClE,IAAT,CAAciE,EAArB;AACD,KAzBI,EAyBFzC,KAzBE,CAyBIC,GAAG,IAAI;AAAA;;AACd9B,MAAAA,iBAAiB,CAAC,KAAD,CAAjB;AACAF,MAAAA,YAAY,CAAC,KAAD,CAAZ;AACAlC,MAAAA,KAAK,CAACwC,KAAN,CAAY,CAAA0B,GAAG,SAAH,IAAAA,GAAG,WAAH,6BAAAA,GAAG,CAAEyC,QAAL,sFAAelE,IAAf,mGAAqByB,GAArB,gFAA0BiD,OAA1B,KAAqC,oDAAjD;AACD,KA7BI,CAAP;AA8BD,GA3CD;;AA6CA,QAAMK,QAAQ,GAAG,CAAC/E,IAAD,EAAOgD,OAAP,KAAmB;AAClC9F,IAAAA,GAAG,CACA6G,IADH,CACQ,eADR,EACyB;AAAEd,MAAAA,OAAO,EAAEjD,IAAI,CAACgF;AAAhB,KADzB;AAED,GAHD;;AAKA,QAAMC,OAAO,GAAG,CAACxD,GAAD,EAAMuB,OAAN,KAAkB;AAChCO,IAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8B0B,IAAI,CAACC,SAAL,CAAe1D,GAAf,CAA9B;AACD,GAFD;;AAIAvF,EAAAA,SAAS,CAAC,MAAM;AACd+C,IAAAA,WAAW,CAACH,OAAO,CAAC,CAAD,CAAP,CAAWE,QAAZ,CAAX;AACA,QAAI8C,KAAK,GAAG,GAAZ;AACAhD,IAAAA,OAAO,CAACsG,OAAR,CAAiBC,IAAD,IAAU;AACxB,YAAMC,cAAc,GAAGD,IAAI,CAAC/C,SAAL,GAAiB+C,IAAI,CAAC/C,SAAL,CAAeM,MAAhC,GAAyC,CAAhE;AACAd,MAAAA,KAAK,GAAGA,KAAK,GAAGyD,UAAU,CAACF,IAAI,CAACG,KAAN,CAAV,GAAyBF,cAAzC;AACD,KAHD;AAIAzD,IAAAA,WAAW,CAACC,KAAD,CAAX;AACAG,IAAAA,eAAe,CAAC,MAAM;AACpB,UAAIrC,YAAY,CAACI,IAAjB,EAAuB;AACrB,gBAAQJ,YAAY,CAACI,IAAb,CAAkByF,IAA1B;AACE,eAAK,YAAL;AACE,mBAAOF,UAAU,CAAC3F,YAAY,CAACI,IAAb,CAAkBuB,UAAlB,GAA+B,GAAhC,CAAV,GAAiDgE,UAAU,CAAC3D,QAAD,CAAlE;;AACF,eAAK,OAAL;AACE,mBAAO2D,UAAU,CAAC3F,YAAY,CAACI,IAAb,CAAkBwF,KAAnB,CAAjB;;AACF;AACE,mBAAO,CAAP;AANJ;AAQD,OATD,MASO;AACL,eAAO,CAAP;AACD;AACF,KAbc,CAAf;AAeAzD,IAAAA,QAAQ,CAAC,MAAM;AACb,UAAInC,YAAY,CAACI,IAAjB,EAAuB;AACrB,cAAM0F,UAAU,GAAG9D,QAAQ,GAAGI,YAA9B;;AACA,YAAI0D,UAAU,GAAG,CAAjB,EAAoB;AAClBzF,UAAAA,MAAM,CAAC,QAAD,EAAW,MAAX,CAAN;AACA,iBAAO,CAAP;AACD;;AACD,eAAOyF,UAAP;AACD,OAPD,MAOO;AACL,YAAG5D,KAAK,KAAK,CAAb,EAAe;AACb7B,UAAAA,MAAM,CAAC,QAAD,EAAW,MAAX,CAAN;AACD;;AACD,eAAO6B,KAAP;AACD;AACF,KAdO,CAAR;AAeD,GAtCQ,EAsCN,CAAClC,YAAY,CAACI,IAAd,EAAoB4B,QAApB,EAA8BI,YAA9B,EAA4ClD,OAA5C,EAAqDmB,MAArD,CAtCM,CAAT;;AAwCA,QAAM0F,8BAA8B,GAAG,MAAM,CAAE,CAA/C;;AAEA,sBACE;AAAK,IAAA,SAAS,EAAC,UAAf;AAAA,4BACE;AAAK,MAAA,SAAS,EAAC,MAAf;AAAA,8BACE;AAAK,QAAA,SAAS,EAAC,8BAAf;AAAA,gCACE;AAAK,UAAA,SAAS,EAAC,2BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE;AAAK,UAAA,SAAS,EAAC,6BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFF,EAGG7G,OAAO,CAAC2D,GAAR,CAAa4C,IAAD,iBACX;AAAA,iCACE;AAAK,YAAA,SAAS,EAAC,8DAAf;AAAA,oCACE;AACE,cAAA,SAAS,EAAC,wCADZ;AAEE,cAAA,KAAK,EAAE;AACLO,gBAAAA,eAAe,EAAG,OAChBP,IAAI,CAACQ,cAAL,GACIR,IAAI,CAACQ,cADT,GAEI,wCACL;AALI;AAFT;AAAA;AAAA;AAAA;AAAA,oBADF,eAWE;AAAK,cAAA,SAAS,EAAC,8DAAf;AAAA,sCACE;AAAI,gBAAA,SAAS,EAAC,MAAd;AAAA,uCACE;AAAA,4BAAIR,IAAI,CAACS;AAAT;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,sBADF,EAIGT,IAAI,CAAC/C,SAAL,iBACC;AAAK,gBAAA,SAAS,EAAC,WAAf;AAAA,uCAEE;AACE,kBAAA,KAAK,EAAE;AACLyD,oBAAAA,OAAO,EAAE,MADJ;AAELC,oBAAAA,mBAAmB,EAAE,uCAFhB;AAGLC,oBAAAA,SAAS,EAAE,EAHN;AAILC,oBAAAA,MAAM,EAAE;AAJH,mBADT;AAAA,4BAQGb,IAAI,CAAC/C,SAAL,CAAeG,GAAf,CAAoB0D,QAAD,iBAClB,QAAC,MAAD;AACE,oBAAA,IAAI,eACF;AACE,sBAAA,GAAG,EAAE7I,QAAQ,CAAC6I,QAAQ,CAACC,KAAV,CADf;AAEE,sBAAA,GAAG,EAAED,QAAQ,CAACE,QAFhB;AAGE,sBAAA,KAAK,EAAC,kBAHR;AAIE,sBAAA,MAAM,EAAE,EAJV;AAKE,sBAAA,KAAK,EAAE,EALT;AAME,sBAAA,KAAK,EAAE;AAAEC,wBAAAA,SAAS,EAAE,OAAb;AAAsBC,wBAAAA,cAAc,EAAE;AAAtC;AANT;AAAA;AAAA;AAAA;AAAA,4BAFJ;AAWE,oBAAA,KAAK,eACH;AAAM,sBAAA,SAAS,EAAC,mBAAhB;AAAA,gCACGJ,QAAQ,CAACE;AADZ;AAAA;AAAA;AAAA;AAAA;AAZJ,qBAgBOF,QAAQ,CAACE,QAhBhB;AAAA;AAAA;AAAA;AAAA,0BADD;AARH;AAAA;AAAA;AAAA;AAAA;AAFF;AAAA;AAAA;AAAA;AAAA,sBALJ;AAAA;AAAA;AAAA;AAAA;AAAA,oBAXF,eAkDE;AAAK,cAAA,SAAS,EAAC,8CAAf;AAAA,qCACE;AAAK,gBAAA,SAAS,EAAC,yDAAf;AAAA,uCACE;AAAK,kBAAA,SAAS,EAAC,oFAAf;AAAA,6BACGxI,aAAa,CAACwH,IAAI,CAACG,KAAN,EAAaxG,QAAb,CADhB,eAEE;AAAM,oBAAA,SAAS,EAAC,eAAhB;AAAA,oCACIqG,IAAI,CAAC/C,SAAL,GAAiB+C,IAAI,CAAC/C,SAAL,CAAeM,MAAhC,GAAyC,CAD7C;AAAA;AAAA;AAAA;AAAA;AAAA,0BAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBAlDF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBADD,CAHH;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,EA0EG,CAAChD,YAAY,CAACI,IAAd,IAAsBnD,CAAC,CAAC2J,KAAF,CAAQ1E,KAAR,EAAe,CAAf,IAAoB,CAA1C;AAAA;AAAiD;AAChD;AAAK,QAAA,SAAS,EAAC,yCAAf;AAAA,gCACE,QAAC,YAAD;AACE,UAAA,IAAI,EAAC,2BADP;AAEE,UAAA,KAAK,EAAC,EAFR;AAGE,UAAA,IAAI,EAAC,MAHP;AAIE,UAAA,WAAW,EAAC,eAJd;AAKE,UAAA,QAAQ,EAAElC,YAAY,CAACR;AALzB;AAAA;AAAA;AAAA;AAAA,gBADF,eAQE;AACE,UAAA,SAAS,EAAC,iDADZ;AAEE,UAAA,OAAO,EAAEyB,4BAFX;AAAA,oBAIGjB,YAAY,CAACR,OAAb,gBACC;AAAA,oCACE;AACE,cAAA,KAAK,EAAC,kCADR;AAEE,cAAA,IAAI,EAAC,QAFP;AAGE,cAAA,KAAK,EAAE;AAAEqH,gBAAAA,KAAK,EAAE,EAAT;AAAaC,gBAAAA,MAAM,EAAE;AAArB,eAHT;AAAA,qCAKE;AAAM,gBAAA,KAAK,EAAC,SAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AALF;AAAA;AAAA;AAAA;AAAA,oBADF;AAAA;AAAA;AAAA;AAAA;AAAA,kBADD,gBAYC;AAAK,YAAA,KAAK,EAAE;AAAED,cAAAA,KAAK,EAAE;AAAT,aAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAhBJ;AAAA;AAAA;AAAA;AAAA,gBARF;AAAA;AAAA;AAAA;AAAA;AAAA,cA3EJ,EAyGG7G,YAAY,CAACI,IAAb,iBACC;AAAA,gCACE;AAAO,UAAA,SAAS,EAAC,gBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE;AAAA,iCACE;AACE,YAAA,KAAK,EAAE;AACL2G,cAAAA,MAAM,EAAE,WADH;AAELC,cAAAA,OAAO,EAAE,CAFJ;AAGLC,cAAAA,YAAY,EAAE,CAHT;AAILC,cAAAA,QAAQ,EAAE,EAJL;AAKLC,cAAAA,UAAU,EAAE,GALP;AAMLC,cAAAA,KAAK,EAAE;AANF,aADT;AAAA,uBAUGpH,YAAY,CAACI,IAAb,CAAkBgB,IAVrB,eAWE;AACE,cAAA,SAAS,EAAC,4BADZ;AAEE,cAAA,KAAK,EAAE;AAAEiG,gBAAAA,OAAO,EAAE,GAAX;AAAgBC,gBAAAA,MAAM,EAAE;AAAxB,eAFT;AAGE,cAAA,OAAO,EAAEvF;AAHX;AAAA;AAAA;AAAA;AAAA,oBAXF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,cA1GJ,eAiIE;AAAK,QAAA,SAAS,EAAC,mBAAf;AAAA,gCACE;AAAK,UAAA,SAAS,EAAC,0CAAf;AAAA,kCACE;AAAO,YAAA,SAAS,EAAC,WAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAK,YAAA,KAAK,EAAE;AAAEoE,cAAAA,OAAO,EAAE,MAAX;AAAmBG,cAAAA,MAAM,EAAE;AAA3B,aAAZ;AAAA,oCACE,QAAC,YAAD;AACE,cAAA,IAAI,EAAC,MADP;AAEE,cAAA,IAAI,EAAC,eAFP;AAGE,cAAA,KAAK,EAAC,gBAHR;AAIE,cAAA,WAAW,EAAC;AAJd;AAAA;AAAA;AAAA;AAAA,oBADF,eAOE,QAAC,YAAD;AACE,cAAA,IAAI,EAAC,MADP;AAEE,cAAA,IAAI,EAAC,gBAFP;AAGE,cAAA,KAAK,EAAC,uBAHR;AAIE,cAAA,WAAW,EAAC;AAJd;AAAA;AAAA;AAAA;AAAA,oBAPF,eAaE;AAAK,cAAA,KAAK,EAAE;AAAEH,gBAAAA,OAAO,EAAE,MAAX;AAAmBG,gBAAAA,MAAM,EAAE;AAA3B,eAAZ;AAAA,sCACE;AACE,gBAAA,KAAK,EAAE;AACLH,kBAAAA,OAAO,EAAE,MADJ;AAELC,kBAAAA,mBAAmB,EAAE,uCAFhB;AAGLC,kBAAAA,SAAS,EAAE;AAHN,iBADT;AAAA,wCAOE,QAAC,OAAD;AAAS,kBAAA,YAAY,EAAE;AAAE3F,oBAAAA,MAAM,EAAE;AAAV,mBAAvB;AAAA,4BACI6G,KAAD,IACC;AACCA,kBAAAA,KAAK,CAAC7G,MAAN,CAAa8G,OAAb,IACCD,KAAK,CAAC7G,MAAN,CAAajB,KADd,KAEE3B,IAAI,CAAC2J,gBAAL,CAAsBF,KAAK,CAAC7G,MAAN,CAAa8G,OAAnC,EAA4CD,KAAK,CAAC7G,MAAN,CAAajB,KAAzD,EACEuD,MADF,gBAEC,QAAC,aAAD;AACE,oBAAA,KAAK,EAAE,MADT;AAEE,oBAAA,IAAI,EAAC,MAFP;AAGE,oBAAA,OAAO,EAAElF,IAAI,CAAC2J,gBAAL,CACPF,KAAK,CAAC7G,MAAN,CAAa8G,OADN,EAEPD,KAAK,CAAC7G,MAAN,CAAajB,KAFN,EAGPoD,GAHO,CAGH;AAAA,0BAAC;AAAE6E,wBAAAA,IAAI,EAAExE;AAAR,uBAAD;AAAA,6BAAsB;AAC1BA,wBAAAA,KAAK,EAAG,GAAEA,KAAM,EADU;AAE1B5B,wBAAAA,KAAK,EAAE4B;AAFmB,uBAAtB;AAAA,qBAHG;AAHX;AAAA;AAAA;AAAA;AAAA,0BAFD,gBAcC,QAAC,YAAD;AACE,oBAAA,IAAI,EAAC,MADP;AAEE,oBAAA,IAAI,EAAC,MAFP;AAGE,oBAAA,KAAK,EAAC,MAHR;AAIE,oBAAA,WAAW,EAAC;AAJd;AAAA;AAAA;AAAA;AAAA,0BAhBH,CAAD,iBAsBS;AAAA;AAAA;AAAA;AAAA;AAzBb;AAAA;AAAA;AAAA;AAAA,wBAPF,eAmCE,QAAC,OAAD;AAAS,kBAAA,YAAY,EAAE;AAAExC,oBAAAA,MAAM,EAAE;AAAV,mBAAvB;AAAA,4BACI6G,KAAD,iBACC,QAAC,aAAD;AACE,oBAAA,KAAK,EAAC,OADR;AAEE,oBAAA,IAAI,EAAC,OAFP;AAGE,oBAAA,OAAO,EAAE1J,kBAAkB,CAAC0J,KAAK,CAAC7G,MAAN,CAAa8G,OAAd,CAAlB,CAAyC3E,GAAzC,CACP;AAAA,0BAAC;AAAE6E,wBAAAA,IAAI,EAAExE,KAAR;AAAeyE,wBAAAA,OAAO,EAAErG,KAAxB;AAA+BsG,wBAAAA,IAAI,EAAEC;AAArC,uBAAD;AAAA,6BAAmD;AACjD3E,wBAAAA,KAAK,EAAG,GAAEA,KAAM,IAAG2E,KAAK,GAAGA,KAAH,GAAW,EAAG,EADW;AAEjDvG,wBAAAA;AAFiD,uBAAnD;AAAA,qBADO;AAHX;AAAA;AAAA;AAAA;AAAA;AAFJ;AAAA;AAAA;AAAA;AAAA,wBAnCF;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,eAmDE;AACE,gBAAA,KAAK,EAAE;AACL6E,kBAAAA,OAAO,EAAE,MADJ;AAELC,kBAAAA,mBAAmB,EAAE,uCAFhB;AAGLC,kBAAAA,SAAS,EAAE;AAHN,iBADT;AAAA,wCAOE,QAAC,YAAD;AACE,kBAAA,IAAI,EAAC,MADP;AAEE,kBAAA,IAAI,EAAC,YAFP;AAGE,kBAAA,KAAK,EAAC,aAHR;AAIE,kBAAA,WAAW,EAAC;AAJd;AAAA;AAAA;AAAA;AAAA,wBAPF,eAaE,QAAC,aAAD;AACE,kBAAA,KAAK,EAAC,SADR;AAEE,kBAAA,IAAI,EAAC,SAFP;AAGE,kBAAA,OAAO,EAAEzI,OAAO,CAACkK,eAAR,GAA0BjF,GAA1B,CACP;AAAA,wBAAC;AAAE6E,sBAAAA,IAAI,EAAExE,KAAR;AAAeyE,sBAAAA,OAAO,EAAErG,KAAxB;AAA+BsG,sBAAAA,IAAI,EAAEC;AAArC,qBAAD;AAAA,2BAAmD;AACjD3E,sBAAAA,KAAK,EAAG,GAAEA,KAAM,IAAG2E,KAAK,GAAGA,KAAH,GAAW,EAAG,EADW;AAEjDvG,sBAAAA;AAFiD,qBAAnD;AAAA,mBADO;AAHX;AAAA;AAAA;AAAA;AAAA,wBAbF;AAAA;AAAA;AAAA;AAAA;AAAA,sBAnDF;AAAA;AAAA;AAAA;AAAA;AAAA,oBAbF;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFF,eA4FE;AAAK,YAAA,SAAS,EAAC,MAAf;AAAA,oCACE;AAAO,cAAA,SAAS,EAAC,WAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE,QAAC,YAAD;AAAc,cAAA,IAAI,EAAC,MAAnB;AAA0B,cAAA,IAAI,EAAC,OAA/B;AAAuC,cAAA,KAAK,EAAC,EAA7C;AAAgD,cAAA,WAAW,EAAC;AAA5D;AAAA;AAAA;AAAA;AAAA,oBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,kBA5FF;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAkGE;AAAA;AAAA;AAAA;AAAA,gBAlGF,EAoGG,sBACC;AAAK,UAAA,SAAS,EAAC,sCAAf;AAAA,kCACE;AAAO,YAAA,SAAS,EAAC,WAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AACE,YAAA,SAAS,EAAC,0BADZ;AAEE,YAAA,KAAK,EAAE;AAAE6E,cAAAA,OAAO,EAAE3G,OAAO,GAAG,OAAH,GAAa,MAA/B;AAAuCqH,cAAAA,KAAK,EAAE;AAA9C,aAFT;AAAA,oCAIE;AAAK,cAAA,SAAS,EAAC,6BAAf;AAA6C,cAAA,IAAI,EAAC,QAAlD;AAAA,qCACE;AAAM,gBAAA,SAAS,EAAC,SAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBAJF,eAOE;AAAK,cAAA,SAAS,EAAC,cAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAPF;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFF,eAWE;AACE,YAAA,SAAS,EAAC,aADZ;AAEE,YAAA,KAAK,EAAE;AACLV,cAAAA,OAAO,EACL,CAAC3G,OAAD,IAAYuI,MAAM,CAACC,IAAP,CAAY/I,UAAZ,EAAwB+D,MAAxB,GAAiC,CAA7C,GAAiD,OAAjD,GAA2D,MAFxD;AAGL6D,cAAAA,KAAK,EAAE;AAHF,aAFT;AAAA,mCAQE;AAAK,cAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AARF;AAAA;AAAA;AAAA;AAAA,kBAXF,EAwBGvG,YAAY,iBAAI,QAAC,KAAD;AAAO,YAAA,IAAI,EAAC;AAAZ;AAAA;AAAA;AAAA;AAAA,kBAxBnB,EAyBGrB,UAAU,iBACT,QAAC,OAAD;AAAS,YAAA,YAAY,EAAE;AAAEyB,cAAAA,MAAM,EAAE;AAAV,aAAvB;AAAA,sBACI6G,KAAD,iBACC;AACE,cAAA,KAAK,EAAE;AACLT,gBAAAA,MAAM,EAAE,MADH;AAELmB,gBAAAA,QAAQ,EAAE;AAFL,eADT;AAAA,qCAME,QAAC,eAAD;AAAiB,gBAAA,eAAe,MAAhC;AAAA,0BACI,CAACV,KAAK,CAAC7G,MAAN,CAAaM,MAAd,iBACA,QAAC,MAAD,CAAQ,GAAR;AAEE,kBAAA,OAAO,EAAE;AAAEqG,oBAAAA,OAAO,EAAE;AAAX,mBAFX;AAGE,kBAAA,OAAO,EAAE;AAAEA,oBAAAA,OAAO,EAAE;AAAX,mBAHX,CAIE;AAJF;AAKE,kBAAA,IAAI,EAAE;AAAEA,oBAAAA,OAAO,EAAE;AAAX,mBALR;AAME,kBAAA,KAAK,EAAE;AACLlB,oBAAAA,OAAO,EAAE,MADJ;AAELC,oBAAAA,mBAAmB,EAAE,sCAFhB;AAGL8B,oBAAAA,GAAG,EAAE,EAHA;AAILrB,oBAAAA,KAAK,EAAE;AAJF,mBANT;AAAA,0CAaE,QAAC,gBAAD;AACE,oBAAA,aAAa,EAAE7I,wBAAwB,CACrCE,iCAAiC,CAAC,CAAD,CADI,EAErCe,UAFqC;AADzC;AAAA;AAAA;AAAA;AAAA,0BAbF,eAmBE,QAAC,gBAAD;AACE,oBAAA,aAAa,EAAEjB,wBAAwB,CACrCE,iCAAiC,CAAC,CAAD,CADI,EAErCe,UAFqC;AADzC;AAAA;AAAA;AAAA;AAAA,0BAnBF,eAyBE,QAAC,gBAAD;AACE,oBAAA,aAAa,EAAEjB,wBAAwB,CACrCE,iCAAiC,CAAC,CAAD,CADI,EAErCe,UAFqC;AADzC;AAAA;AAAA;AAAA;AAAA,0BAzBF,eA+BE,QAAC,0BAAD;AACE,oBAAA,OAAO,eACL,QAAC,mBAAD;AACE,sBAAA,aAAa,EAAE;AACbyI,wBAAAA,IAAI,EAAE,uBADO;AAEb1G,wBAAAA,MAAM,EAAE,QAFK;AAGbmH,wBAAAA,IAAI,EAAE;AAHO,uBADjB;AAME,sBAAA,OAAO,EAAEpC;AANX;AAAA;AAAA;AAAA;AAAA,4BAFJ;AAWE,oBAAA,QAAQ,EAAE/D;AAXZ;AAAA;AAAA;AAAA;AAAA,0BA/BF;AAAA,mBACM,6BADN;AAAA;AAAA;AAAA;AAAA,wBADD,iBA+CC,QAAC,MAAD,CAAQ,GAAR;AACE,kBAAA,OAAO,EAAE;AAAEqF,oBAAAA,OAAO,EAAE;AAAX,mBADX;AAEE,kBAAA,OAAO,EAAE;AAAEA,oBAAAA,OAAO,EAAE;AAAX,mBAFX;AAGE,kBAAA,IAAI,EAAE;AAAEA,oBAAAA,OAAO,EAAE;AAAX,mBAHR;AAKE,kBAAA,KAAK,EAAE;AACLY,oBAAAA,QAAQ,EAAE;AADL,mBALT;AAAA,yCASE,QAAC,qBAAD;AACE,oBAAA,MAAM,EAAEjK,wBAAwB,CAC9BuJ,KAAK,CAAC7G,MAAN,CAAaM,MADiB,EAE9B/B,UAF8B,CADlC;AAKE,oBAAA,wBAAwB,EAAE6B;AAL5B;AAAA;AAAA;AAAA;AAAA;AATF,mBAIM,uBAJN;AAAA;AAAA;AAAA;AAAA;AAhDJ;AAAA;AAAA;AAAA;AAAA;AANF;AAAA;AAAA;AAAA;AAAA;AAFJ;AAAA;AAAA;AAAA;AAAA,kBA1BJ,EAyGG,SACC,CAACtB,OADF,IAECuI,MAAM,CAACC,IAAP,CAAY/I,UAAZ,EAAwB4D,GAAxB,CAA4B,CAACuF,IAAD,EAAOvH,KAAP,kBAC1B;AAAK,YAAA,SAAS,EAAC,WAAf;AAA2B,YAAA,EAAE,EAAC,kBAA9B;AAAA,mCACE;AAAK,cAAA,SAAS,EAAC,MAAf;AAAA,sCACE;AACE,gBAAA,SAAS,EAAC,aADZ;AAEE,gBAAA,EAAE,EAAG,UAASA,KAAM,EAFtB;AAGE,gBAAA,IAAI,EAAC,QAHP;AAIE,gBAAA,IAAI,EAAC,QAJP;AAKE,gBAAA,OAAO,EAAE,MAAMD,UAAU,CAACC,KAAD,CAL3B;AAME,+BAAY,UANd;AAOE,+BAAc,YAAWA,KAAM,EAPjC;AAQE,iCAAc,OARhB;AASE,iCAAgB,WAAUA,KAAM,EATlC;AAAA,uCAWE;AAAK,kBAAA,SAAS,EAAC,WAAf;AAAA,yCACE;AAAK,oBAAA,SAAS,EAAC,6BAAf;AAAA,4CACE;AAAA,6CACE;AACE,wBAAA,SAAS,EAAC,cADZ;AAEE,uCAAY,UAFd;AAGE,uCAAc,YAAWA,KAAM,EAHjC;AAIE,yCAAc,OAJhB;AAKE,yCAAgB,WAAUA,KAAM,EALlC;AAME,wBAAA,IAAI,EAAC,QANP;AAAA,kCAQGuH;AARH;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,4BADF,eAaE;AAAA,iCACG9I,WAAW,KAAKuB,KAAhB,iBACC;AACE,wBAAA,SAAS,EAAC,cADZ;AAEE,uCAAY,UAFd;AAGE,uCAAc,YAAWA,KAAM,EAHjC;AAIE,yCAAc,OAJhB;AAKE,yCAAgB,WAAUA,KAAM,EALlC;AAME,wBAAA,IAAI,EAAC,QANP;AAAA,+CAQE;AAAG,0BAAA,SAAS,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA;AARF;AAAA;AAAA;AAAA;AAAA,8BAFJ,EAaGvB,WAAW,KAAKuB,KAAhB,iBACC;AACE,wBAAA,SAAS,EAAC,cADZ;AAEE,uCAAY,UAFd;AAGE,uCAAc,YAAWA,KAAM,EAHjC;AAIE,yCAAc,OAJhB;AAKE,yCAAgB,WAAUA,KAAM,EALlC;AAME,wBAAA,IAAI,EAAC,QANP;AAAA,+CAQE;AAAG,0BAAA,SAAS,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA;AARF;AAAA;AAAA;AAAA;AAAA,8BAdJ;AAAA;AAAA;AAAA;AAAA;AAAA,4BAbF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AAXF;AAAA;AAAA;AAAA;AAAA,sBADF,eAwDE;AACE,gBAAA,EAAE,EAAG,WAAUA,KAAM,EADvB;AAEE,gBAAA,SAAS,EAAC,UAFZ;AAGE,mCAAkB,UAASA,KAAM,EAHnC;AAIE,+BAAY,mBAJd;AAAA,uCAME;AAAK,kBAAA,SAAS,EAAC,WAAf;AAAA,yCACE;AAAI,oBAAA,KAAK,EAAC,6BAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AANF;AAAA;AAAA;AAAA;AAAA,sBAxDF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,kBADF,CA3GJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBArGJ;AAAA;AAAA;AAAA;AAAA;AAAA,cAjIF;AAAA;AAAA;AAAA;AAAA;AAAA,YADF,eA6ZE;AAAK,MAAA,SAAS,EAAC,OAAf;AAAA,6BACE;AAAK,QAAA,SAAS,EAAC,mBAAf;AAAA,gCACE;AAAK,UAAA,SAAS,EAAC,6BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE;AAAK,UAAA,SAAS,EAAC,0BAAf;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAK,YAAA,SAAS,EAAC,gBAAf;AAAA,sBAAiC5C,aAAa,CAAC+D,QAAD,EAAU5C,QAAV;AAA9C;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFF,eAME;AAAK,UAAA,SAAS,EAAC,0BAAf;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAK,YAAA,SAAS,EAAC,gBAAf;AAAA,sBACGgD,YAAY,GAAG,CAAf,GAAmB,MAAMnE,aAAa,CAACmE,YAAD,EAAehD,QAAf,CAAtC,GAAiE;AADpE;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBANF,eAYE;AAAI,UAAA,SAAS,EAAC;AAAd;AAAA;AAAA;AAAA;AAAA,gBAZF,eAaE;AAAK,UAAA,SAAS,EAAC,2CAAf;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAK,YAAA,SAAS,EAAC,SAAf;AAAA,sBAA0BnB,aAAa,CAACiE,KAAD,EAAQ9C,QAAR;AAAvC;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAbF,eAiBE;AAAK,UAAA,SAAS,EAAC,cAAf;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAKE;AAAA,yEACiD,GADjD,eAEE;AAAM,cAAA,SAAS,EAAC,qBAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,kBALF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAjBF,EA2BGnC,CAAC,CAAC2J,KAAF,CAAQ1E,KAAR,EAAe,CAAf,MAAsB,CAAtB,iBAA2B;AAC1B,UAAA,SAAS,EAAC,yCADgB;AAE1B,UAAA,IAAI,EAAC,QAFqB;AAG1B,UAAA,QAAQ,EAAE3B,QAAQ,IAAKC,mBAAmB,IAAI,CAACC,oBAHrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBA3B9B,EAkCGxD,CAAC,CAAC2J,KAAF,CAAQ1E,KAAR,EAAe,CAAf,IAAoB,CAApB,iBAAyB;AAAA,kCACxB;AACE,YAAA,IAAI,EAAC,QADP;AAEE,YAAA,SAAS,EAAC,qCAFZ;AAGE,2BAAY,SAHd;AAIE,YAAA,KAAK,EAAC,iDAJR,CAKE;AALF;AAME,YAAA,OAAO,EAAE,MAAM;AAACrC,cAAAA,YAAY,CAAC,IAAD,CAAZ;AAAmB,aANrC;AAAA,oCAQE;AAAG,cAAA,SAAS,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA,oBARF,oBAQ6C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAR7C;AAAA;AAAA;AAAA;AAAA;AAAA,kBADwB,eAWxB,QAAC,oBAAD;AACI,YAAA,OAAO,EAAE;AACL,2BAAad,YAAY,CAACsJ,QADrB;AAELC,cAAAA,UAAU,EAAE,SAFP;AAGLlJ,cAAAA,QAAQ,EAAEA;AAHL,aADb;AAAA,mCAME,QAAC,aAAD;AACM,cAAA,QAAQ,EAAEoB,mBADhB;AAEM,cAAA,KAAK,EAAE0B,KAFb;AAGM,cAAA,QAAQ,EAAEE,YAHhB;AAIM,cAAA,QAAQ,EAAEhD,QAJhB;AAKM,cAAA,WAAW,EAAE,KALnB;AAMM,cAAA,aAAa,EAAE+D,WANrB;AAOM,cAAA,SAAS,EAAEI,SAPjB;AAQM,cAAA,QAAQ,EAAE4B,QARhB;AASM,cAAA,OAAO,EAAEE;AATf;AAAA;AAAA;AAAA;AAAA;AANF;AAAA;AAAA;AAAA;AAAA,kBAXwB;AAAA;AAAA;AAAA;AAAA;AAAA,gBAlC5B;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YA7ZF,eAgeE,QAAC,KAAD;AACE,MAAA,IAAI,EAAC,IADP;AAEE,MAAA,IAAI,EAAEzF,SAFR;AAGE,MAAA,QAAQ,EAAC,QAHX;AAIE,MAAA,QAAQ,EAAE,KAJZ;AAAA,8BAME,QAAC,KAAD,CAAO,MAAP;AAAA,+BACE,QAAC,KAAD,CAAO,KAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cANF,eASE,QAAC,KAAD,CAAO,IAAP;AAAY,QAAA,SAAS,EAAC,cAAtB;AAAA,gCACE;AAAA,2GAAwE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAxE;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAKE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBALF,eAME;AAAO,UAAA,KAAK,EAAC,oCAAb;AAAA,iCACE;AAAA,oCACE;AAAA,sCACE;AAAI,gBAAA,SAAS,EAAC,gBAAd;AAAA,uCAA+B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA/B;AAAA;AAAA;AAAA;AAAA,sBADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,eAKE;AAAA,sCACE;AAAI,gBAAA,SAAS,EAAC,gBAAd;AAAA,uCAA+B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA/B;AAAA;AAAA;AAAA;AAAA,sBADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,oBALF,eASE;AAAA,sCACE;AAAI,gBAAA,SAAS,EAAC,gBAAd;AAAA,uCAA+B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA/B;AAAA;AAAA;AAAA;AAAA,sBADF,eAEE;AAAA;AAAA;AAAA;AAAA,sBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,oBATF,eAaE;AAAA,sCACE;AAAI,gBAAA,SAAS,EAAC,MAAd;AAAA,uCAAqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAArB;AAAA;AAAA;AAAA;AAAA,sBADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,oBAbF,eAiBE;AAAA,sCACE;AAAI,gBAAA,SAAS,EAAC,MAAd;AAAA,uCAAqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAArB;AAAA;AAAA;AAAA;AAAA,sBADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,oBAjBF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBANF,eA+BE;AAAA,iCAAG;AAAA;AAAA;AAAA;AAAA;AAAH;AAAA;AAAA;AAAA;AAAA,gBA/BF;AAAA;AAAA;AAAA;AAAA;AAAA,cATF,eA0CE,QAAC,KAAD,CAAO,MAAP;AAAA,gCACE,QAAC,MAAD;AAAQ,UAAA,OAAO,EAAC,SAAhB;AAA0B,UAAA,OAAO,EAAE,MAAM0D,cAAc,CAAC,KAAD,CAAvD;AAAgE,UAAA,QAAQ,EAAExD,cAA1E;AAAA,kCACE;AACE,YAAA,KAAK,EAAE;AAAEqG,cAAAA,OAAO,EAAErG,cAAc,GAAG,cAAH,GAAoB;AAA7C,aADT;AAEE,YAAA,KAAK,EAAC,2CAFR;AAGE,YAAA,IAAI,EAAC,QAHP;AAIE,2BAAY;AAJd;AAAA;AAAA;AAAA;AAAA,kBADF;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAUE,QAAC,MAAD;AAAQ,UAAA,OAAO,EAAC,WAAhB;AAA4B,UAAA,OAAO,EAAE,MAAMD,YAAY,CAAC,KAAD,CAAvD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAVF;AAAA;AAAA;AAAA;AAAA;AAAA,cA1CF;AAAA;AAAA;AAAA;AAAA;AAAA,YAheF;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AA4hBD,CA7vBD;;GAAMb,Y;UAKY5B,W,EASGP,O,EACmEC,Y,EACpDF,Q,EA0DjBQ,W;;;KA1Eb4B,Y;;AA+vBN,MAAMuJ,aAAa,GAAG,SAA2G;AAAA;;AAAA,MAA1G;AAAErG,IAAAA,KAAF;AAASE,IAAAA,YAAT;AAAuBhD,IAAAA,QAAvB;AAAiCoJ,IAAAA,WAAjC;AAA8CC,IAAAA,QAA9C;AAAwDC,IAAAA,aAAxD;AAAuEnF,IAAAA,SAAvE;AAAkF4B,IAAAA,QAAlF;AAA4FE,IAAAA;AAA5F,GAA0G;AAC7H;AACA;AACA,QAAM,CAAC;AAAEsD,IAAAA,OAAF;AAAWC,IAAAA;AAAX,GAAD,EAAyBC,QAAzB,IAAqC/J,sBAAsB,EAAjE;AAEAxC,EAAAA,SAAS,CAAC,MAAM;AACZuM,IAAAA,QAAQ,CAAC;AACLhD,MAAAA,IAAI,EAAE,cADD;AAELvE,MAAAA,KAAK,EAAE,EACH,GAAGqH,OADA;AAEHvJ,QAAAA,QAAQ,EAAEA;AAFP;AAFF,KAAD,CAAR,CADY,CAQZ;AACH,GATQ,EASN,CAACA,QAAD,EAAWoJ,WAAX,CATM,CAAT;AAYA,sBAAQ;AAAA,eACGA,WAAW,IAAII,SAAhB,iBAA8B;AAAM,MAAA,SAAS,EAAC,2CAAhB;AAA4D,MAAA,IAAI,EAAC,QAAjE;AAA0E,qBAAY;AAAtF;AAAA;AAAA;AAAA;AAAA,YADhC,eAEA,QAAC,aAAD;AACI,MAAA,KAAK,EAAE;AAACxB,QAAAA,KAAK,EAAC,MAAP;AAAelE,QAAAA,KAAK,EAAE;AAAtB,OADX;AAEI,MAAA,QAAQ,EAAEuF,QAFd;AAGI,MAAA,aAAa,EAAE,CAACvG,KAAD,EAAQ9C,QAAR,EAAkBgD,YAAlB,CAHnB;AAII,MAAA,aAAa,EAAE8C,SAJnB;AAKI,MAAA,cAAc,EAAE,QALpB;AAMI,MAAA,WAAW,EAAE,CAAC9E,IAAD,EAAOgD,OAAP,KAAmBsF,aAAa,CAACtI,IAAD,EAAOgD,OAAP,CANjD;AAOI,MAAA,SAAS,EAAE,CAAChD,IAAD,EAAOgD,OAAP,KAAmBG,SAAS,CAACnD,IAAD,EAAOgD,OAAP,CAP3C;AAQI,MAAA,QAAQ,EAAE,CAAChD,IAAD,EAAOgD,OAAP,KAAmB+B,QAAQ,CAAC/E,IAAD,EAAOgD,OAAP,CARzC;AASI,MAAA,OAAO,EAAE,CAAChD,IAAD,EAAOgD,OAAP,KAAmBiC,OAAO,CAACjF,IAAD,EAAOgD,OAAP;AATvC;AAAA;AAAA;AAAA;AAAA,YAFA;AAAA,kBAAR;AAeH,CAhCD;;IAAMmF,a;UAGyCzJ,sB;;;MAHzCyJ,a;AAkCN,eAAe,SAASO,YAAT,GAAwB;AAAA;;AAAA;;AACrC;AACA,QAAMC,QAAQ,GAAG5L,WAAW,EAA5B;AACA,QAAMuH,QAAQ,GAAGxH,WAAW,EAA5B;AACA,QAAM2L,QAAQ,GAAGxL,WAAW,EAA5B;AACA,QAAM4B,UAAU,GAAG7B,WAAW,CAAEqC,KAAD,IAC7BA,KAAK,CAACuJ,OAAN,GAAgBvJ,KAAK,CAACuJ,OAAN,CAAcrJ,KAAd,CAAoB,CAAC,MAAD,EAAS,YAAT,CAApB,CAAhB,GAA8D,EADlC,CAA9B,CALqC,CAQrC;AACA;AACA;;AACA,QAAMiD,IAAI,GAAGxF,WAAW,CAAEqC,KAAD,IAAYA,KAAK,CAAC8C,IAAN,CAAWK,IAAX,GAAkBnD,KAAK,CAAC8C,IAAN,CAAWK,IAA7B,GAAoC,EAAjD,CAAxB;AACA,QAAMN,QAAQ,GAAGlF,WAAW,CAACqC,KAAK,IAAIA,KAAK,CAAC8C,IAAhB,CAA5B;AAEA,QAAMqC,YAAY,GAAG;AACnBqE,IAAAA,QAAQ,qBAAEvE,QAAQ,CAACjF,KAAX,oDAAE,gBAAgBwJ,QADP;AAEnBhF,IAAAA,OAAO,sBAAES,QAAQ,CAACjF,KAAX,qDAAE,iBAAgBwE,OAFN;AAGnBiF,IAAAA,YAAY,sBAAExE,QAAQ,CAACjF,KAAX,qDAAE,iBAAgByJ,YAHX;AAInBhK,IAAAA,OAAO,sBAAEwF,QAAQ,CAACjF,KAAX,qDAAE,iBAAgBP;AAJN,GAArB;;AAOA,QAAMiK,SAAS,GAAG,YAAY;AAC5B5L,IAAAA,aAAa,CAACsL,QAAD,CAAb;AACD,GAFD;;AAGA,QAAMpG,YAAY,GAAIC,SAAD,IACnBJ,QAAQ,CAACK,WAAT,KAAyB,SAAzB,GAAqC,CAAC,EAAE,GAAGL,QAAQ,CAACM;AAAd,GAAD,CAArC,GAA8DF,SADhE;;AAEA,QAAM0G,MAAM,GAAI1I,MAAD,IAAY;AACzB;AACA;AACA,UAAMsD,UAAU,GAAGY,YAAY,CAAC1F,OAAb,CAAqB2D,GAArB,CAAyB,UAAkC;AAAA,UAAjC;AAACoB,QAAAA,OAAD;AAAUvB,QAAAA,SAAV;AAAqBwB,QAAAA;AAArB,OAAiC;AAC5E,aAAO;AAACD,QAAAA,OAAD;AAAUvB,QAAAA,SAAS,EAAED,YAAY,CAACC,SAAD,CAAjC;AAA8CwB,QAAAA;AAA9C,OAAP;AACD,KAFkB,CAAnB;AAGA5G,IAAAA,GAAG,CACA6G,IADH,CACS,YAAWvB,IAAI,CAACiD,IAAK,EAD9B,EACiC,EAC7B,GAAGnF,MAD0B;AAE7BxB,MAAAA,OAAO,EAAE8E;AAFoB,KADjC,EAKGxC,IALH,CAKS8C,QAAD,IAAc;AAClB,UAAIA,QAAQ,CAAClE,IAAT,CAAciJ,IAAd,KAAuB,IAA3B,EAAiC;AAC/B,cAAM9E,WAAW,GAAG,IAAIC,GAAJ,CAAS,GAAEC,MAAM,CAACC,QAAP,CAAgBC,MAAO,gBAAlC,CAApB;AACAJ,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,OAAhC,EAAyCP,QAAQ,CAAClE,IAAT,CAAcoC,KAAvD;AACA+B,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,OAAhC,EAAyCP,QAAQ,CAAClE,IAAT,CAAcoC,KAAvD;AACA+B,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,QAAhC,EAA0C,GAA1C;AACAN,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,SAAhC,EAA2C,iBAA3C;AACAN,QAAAA,WAAW,CAACK,YAAZ,CAAyBC,MAAzB,CAAgC,QAAhC,EAA0CP,QAAQ,CAAClE,IAAT,CAAc2E,MAAxD;AACAN,QAAAA,MAAM,CAACC,QAAP,CAAgBM,OAAhB,CAAwBT,WAAW,CAACU,IAApC;AACD,OARD,MAQO;AACLR,QAAAA,MAAM,CAACC,QAAP,CAAgBM,OAAhB,CAAwBV,QAAQ,CAAClE,IAAT,CAAckJ,GAAtC;AACD;AACF,KAjBH,EAkBG1H,KAlBH,CAkBUzB,KAAD,IAAW;AAChBxC,MAAAA,KAAK,CAACwC,KAAN,CAAY,yDAAZ;AACAwD,MAAAA,OAAO,CAACC,GAAR,CAAYzD,KAAZ;AACD,KArBH,EANyB,CA4BzB;AACD,GA7BD,CA1BqC,CAyDrC;AACA;AACA;;;AACA7D,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI,CAACsG,IAAD,IAAS,CAACgC,YAAY,CAAC,SAAD,CAA1B,EAAuCmE,QAAQ,CAAC,GAAD,EAAM;AAAE/D,MAAAA,OAAO,EAAE;AAAX,KAAN,CAAR;AACvCmE,IAAAA,SAAS,GAFK,CAGd;AACD,GAJQ,EAIN,EAJM,CAAT;AAMA,QAAMI,QAAQ,GAAG/L,mBAAmB,CAAChB,iBAAD,CAApC;AAEA,sBACE,QAAC,IAAD;AACE,IAAA,QAAQ,EAAE4M,MADZ;AAEE,IAAA,QAAQ,EAAEG,QAFZ;AAGE,IAAA,aAAa,EAAE;AACbvI,MAAAA,MAAM,EAAE,MADK;AAEbwI,MAAAA,KAAK,EAAE5G,IAAF,aAAEA,IAAF,uBAAEA,IAAI,CAAE4G,KAFA;AAGbhC,MAAAA,OAAO,EAAE,IAHI;AAIb/H,MAAAA,KAAK,EAAE,KAJM;AAKbgK,MAAAA,IAAI,EAAE;AALO,KAHjB;AAUE,IAAA,MAAM,EAAE;AAAA,UAAC;AAAEC,QAAAA;AAAF,OAAD;AAAA,0BACN;AAAM,QAAA,SAAS,EAAC,yBAAhB;AAA0C,QAAA,QAAQ,EAAEA,YAApD;AAAA,gCACE;AAAK,UAAA,SAAS,EAAC,QAAf;AAAA,iCACE,QAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBADF,eAIE;AAAK,UAAA,SAAS,EAAC,SAAf;AAAA,iCAEE,QAAC,YAAD;AACE,YAAA,UAAU,EAAEzK,UADd;AAEE,YAAA,SAAS,EAAE2F,YAAY,CAACqE,QAF1B;AAGE,YAAA,OAAO,EAAErE,YAAY,CAAC1F,OAHxB;AAIE,YAAA,QAAQ,EAAE0D,IAAI,CAACiD;AAJjB;AAAA;AAAA;AAAA;AAAA;AAFF;AAAA;AAAA;AAAA;AAAA,gBAJF;AAAA;AAAA;AAAA;AAAA;AAAA,cADM;AAAA;AAVV;AAAA;AAAA;AAAA;AAAA,UADF;AA6BD;;IAjGuBiD,Y;UAEL3L,W,EACAD,W,EACAG,W,EACED,W,EAMNA,W,EACIA,W,EAsDAI,mB;;;MAlEKsL,Y","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport checkoutValidator from \"../../validators/checkout\";\nimport Header from \"../Header/index\";\nimport \"./index.css\";\nimport { Form, FormSpy, useField, useForm, useFormState } from \"react-final-form\";\nimport { SelectControl, InputControl } from \"components/common/Form/Inputs\";\nimport _ from \"lodash\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { api } from \"../../api\";\nimport { getProcessors } from \"api/payment\";\nimport useValidationSchema from \"hooks/use-validation-schema\";\nimport Avatar from \"../common/Avatar/index\";\nimport { getS3Url } from \"utils/teacherApplication\";\nimport { toast } from \"react-toastify\";\nimport { Country } from \"country-state-city\";\nimport { getStatesOfCountry } from \"country-state-city/dist/lib/state\";\nimport CITY from \"country-state-city/dist/lib/city\";\nimport SelectedPaymentMethod from \"./SelectedPaymentMethod\";\nimport { getPaymentMethodByProcId, toMoneyFormat } from \"utils/utils\";\nimport { CHECKOUT_PAGE_TOP_PAYMENT_METHODS, LEARNER_GRADE_LEVELS } from \"utils/constants\";\nimport TopPaymentMethod from \"./TopPaymentMethod/index\";\nimport OtherPaymentMethods from \"./OtherPaymentMethods\";\nimport { AnimatePresence, motion } from \"framer-motion\";\nimport PaymentMethodSelectorModal from \"./PaymentMethodSelectorModal/index\";\nimport { Error } from \"../common/Form/Inputs\";\nimport { Modal, Button } from \"react-bootstrap\";\nimport {\n  PayPalScriptProvider,\n  PayPalButtons,\n  usePayPalScriptReducer\n} from \"@paypal/react-paypal-js\";\nimport { paypalConfig } from \"../../config/index\";\n// import { paypalConfig } from \"config\";\n\n// const PayPalButton = window.paypal.Buttons.driver(\"react\", { React, ReactDOM });\n\nconst CheckoutForm = ({ processors, classes, userType }) => {\n  // const CURRENCY_SYMBOL = \"USD\";\n  // enrollees = null if user is solo learner, otherwise (user is family account) array of learners\n  const [currency, setCurrency] = useState(\"USD\");\n  const [paymentMode, setPaymentMode] = useState(-1);\n  const loading = useSelector((state) => state.uiElements.getIn([\"loadingScreen\"]));\n  const [showModal, setShowModal] = useState(false);\n  const [loadingPayment, setLoadingPayment] = useState(false);\n  const [discountCode, setDiscountCode] = useState({\n    loading: false,\n    success: false,\n    error: false,\n    data: null,\n  });\n  const { change } = useForm();\n  const { submitFailed, pristine, hasValidationErrors, dirtySinceLastSubmit, values } = useFormState();\n  const notValidated_discountCode = useField(\"notValidated_discountCode\");\n\n  const expandMode = (index) => {\n    if (index === paymentMode) {\n      setPaymentMode(-1);\n    } else {\n      setPaymentMode(index);\n    }\n  };\n\n  const handleClickPaymentMethod = (method) => {\n    change(\"procId\", method.procId);\n  };\n\n  const handleClickApplyDiscountCode = (e) => {\n    e.preventDefault();\n    const code = notValidated_discountCode.input.value; // Get not validated discount code\n\n    setDiscountCode((discountCode) => ({ ...discountCode, loading: true }));\n    api\n      .get(`discount/apply/${code}`)\n      .then((result) => {\n        if (!result.data.discount.percentage) result.data.discount.percentage = 0; // Handles when \"percentage\" field of discount is null\n        setDiscountCode((discountCode) => ({\n          ...discountCode,\n          error: false,\n          success: true,\n          data: result.data.discount,\n        }));\n        // if code is not valid update its value in react final form to null\n        change(\"discountCode\", result.data.discount.code);\n        toast.success(\"Discount Code Successfully Applied!\");\n      })\n      .catch((err) => {\n        toast.error(\"Invalid Discount Code\");\n        setDiscountCode((discountCode) => ({\n          ...discountCode,\n          error: true,\n          success: false,\n          data: null,\n        }));\n        // otherwise set value to null\n        change(\"discountCode\", null);\n        change(\"notValidated_discountCode\", null);\n      })\n      .finally(() => {\n        setDiscountCode((discountCode) => ({ ...discountCode, loading: false }));\n      });\n  };\n  const handleClickRemoveDiscountCode = () => {\n    setDiscountCode((discountCode) => ({ ...discountCode, data: null }));\n    change(\"discountCode\", null);\n  };\n\n  // const PRICE_MULTIPLIER = enrollees ? enrollees.length : 1;\n  const [subTotal, setSubTotal] = useState(0);\n  const [total, setTotal] = useState(0);\n  const [cashDiscount, setCashDiscount] = useState(0);\n  const userAuth = useSelector(state => state.auth);\n  let txnId = null;\n  \n  const getEnrollees = (enrollees) => \n    (userAuth.accountType === 'learner' ? [{ ...userAuth.user }] : enrollees ).map(({gradeLevel, ...others})=>({...others, gradeLevel: gradeLevel?.length ? LEARNER_GRADE_LEVELS.find(({value})=> gradeLevel === value).label:''}))\n  \n  const createOrder = async (data, actions) => {\n    // console.log('classParam', classParam, classes);\n    const orderId = await processPayment(values[\"procId\"]);\n\n    return orderId;\n  }\n\n  const onApprove = (data, actions) => {\n    return actions.order.capture().then(function (order, res) {\n      console.log('onApprove', order, order.purchase_units[0].payments.captures[0]);\n      const classParam = classes.map(({classId, enrollees, cartId}) => {\n        return {classId, \n          enrollees:\n          // If user is solo-learner, then he is an enrollee in enrollees array.\n          // Else, a family account, and the selected learners are the enrollees\n          getEnrollees(enrollees), \n          cartId};\n      });\n      return api\n      .post(`/payment/${userType}/paypal/checkout`, {\n        // discountCode: discountCode.data ? discountCode.data.code : undefined,\n        classes: classParam,\n        txnId,\n        // orderId: order.id,\n        captureId: order.purchase_units[0].payments.captures[0].id,\n        // capture: order.purchase_units[0].payments.captures[0],\n        // fee: order.purchase_units.payments.captures[0].seller_receivable_breakdown.paypal_fee.value\n      })\n      .then((response) => {\n        const redirectUrl = new URL(`${window.location.origin}/order-summary`);\n          redirectUrl.searchParams.append(\"txnid\", response.data.txnId);\n          redirectUrl.searchParams.append(\"refno\", order.orderId);\n          redirectUrl.searchParams.append(\"status\", \"S\");\n          redirectUrl.searchParams.append(\"message\", response.data.message);\n          redirectUrl.searchParams.append(\"param1\", response.data.param1);\n          redirectUrl.searchParams.append(\"currency\", currency);\n          redirectUrl.searchParams.append(\"subTotal\", subTotal);\n          redirectUrl.searchParams.append(\"cashDiscount\", cashDiscount);\n          redirectUrl.searchParams.append(\"total\", total);\n          window.location.replace(redirectUrl.href);\n          return response;\n      })\n      .catch((error) => {\n        toast.error(\"Failed to connect with payment. Please try again later.\");\n        console.log(error);\n      });\n    });\n  }\n\n  const processPayment = async (procId) => {\n    setLoadingPayment(true);\n    const classParam = classes.map(({ classId, enrollees, cartId }) => {\n      return {\n        classId,\n        enrollees:\n          // If user is solo-learner, then he is an enrollee in enrollees array.\n          // Else, a family account, and the selected learners are the enrollees\n          getEnrollees(enrollees), \n        cartId\n      };\n    });\n\n    return api\n      .post(`/payment/${userType}/pay`, {\n        discountCode: discountCode.data ? discountCode.data.code : undefined,\n        classes: classParam,\n        procId\n      })\n      .then((response) => {\n        setLoadingPayment(false);\n        setShowModal(false);\n        txnId = response.data.txnId;\n        if(procId !== \"PYPL\"){\n          const redirectUrl = new URL(`${window.location.origin}/order-summary`);\n          redirectUrl.searchParams.append(\"txnid\", response.data.txnId);\n          redirectUrl.searchParams.append(\"refno\", null);\n          redirectUrl.searchParams.append(\"status\", \"P\");\n          redirectUrl.searchParams.append(\"message\", response.data.message);\n          redirectUrl.searchParams.append(\"param1\", response.data.param1);\n          redirectUrl.searchParams.append(\"currency\", currency);\n          redirectUrl.searchParams.append(\"subTotal\", subTotal);\n          redirectUrl.searchParams.append(\"cashDiscount\", cashDiscount);\n          redirectUrl.searchParams.append(\"total\", total);\n          window.location.replace(redirectUrl.href);\n          return response;\n        }\n        return response.data.id\n      }).catch(err => {\n        setLoadingPayment(false);\n        setShowModal(false);\n        toast.error(err?.response?.data?.err?.message || 'Failed initiating payment. Please try again later.');\n      }); \n  }\n\n  const onCancel = (data, actions) => {\n    api\n      .post('/payment/void', { orderId: data.orderID });\n  }\n\n  const onError = (err, actions) => {\n    console.log('onErrorPayment', JSON.stringify(err));\n  }\n\n  useEffect(() => {\n    setCurrency(classes[0].currency);\n    let total = 0.0;\n    classes.forEach((item) => {\n      const enrolleesCount = item.enrollees ? item.enrollees.length : 1;\n      total = total + parseFloat(item.price) * enrolleesCount;\n    });\n    setSubTotal(total);\n    setCashDiscount(() => {\n      if (discountCode.data) {\n        switch (discountCode.data.type) {\n          case \"percentage\":\n            return parseFloat(discountCode.data.percentage / 100) * parseFloat(subTotal);\n          case \"value\":\n            return parseFloat(discountCode.data.price);\n          default:\n            return 0;\n        }\n      } else {\n        return 0;\n      }\n    });\n\n    setTotal(() => {\n      if (discountCode.data) {\n        const discounted = subTotal - cashDiscount;\n        if (discounted < 0) {\n          change(\"procId\", \"none\");\n          return 0;\n        }\n        return discounted;\n      } else {\n        if(total === 0){\n          change(\"procId\", \"none\");\n        }\n        return total;\n      }\n    });\n  }, [discountCode.data, subTotal, cashDiscount, classes, change]);\n\n  const handleClickOtherPaymentMethods = () => {};\n\n  return (\n    <div className=\"checkout\">\n      <div className=\"left\">\n        <div className=\"checkout__order-details mb-4\">\n          <div className=\"custom-black-primary-text\">Checkout</div>\n          <div className=\"custom-black-secondary-text\">Order Details</div>\n          {classes.map((item) => (\n            <div>\n              <div className=\"checkout__order-details__detail justify-content-between mb-2\">\n                <div\n                  className=\"checkout__order-details__detail__image\"\n                  style={{\n                    backgroundImage: `url(${\n                      item.thumbnailImage\n                        ? item.thumbnailImage\n                        : \"../assets/images/image-placeholder.jpg\"\n                    })`,\n                  }}\n                ></div>\n                <div className=\"checkout__order-details__detail__description__title col ml-0\">\n                  <h5 className=\"mb-3\">\n                    <b>{item.title}</b>\n                  </h5>\n                  {item.enrollees && (\n                    <div className=\"mt-2 mb-5\">\n                      {/* <p>for learners:</p> */}\n                      <div\n                        style={{\n                          display: \"grid\",\n                          gridTemplateColumns: \"repeat(auto-fill, minmax(100px, 1fr))\",\n                          columnGap: 10,\n                          rowGap: 10,\n                        }}\n                      >\n                        {item.enrollees.map((enrollee) => (\n                          <Avatar\n                            left={\n                              <img\n                                src={getS3Url(enrollee.photo)}\n                                alt={enrollee.nickname}\n                                class=\"profile-pic mr-2\"\n                                height={30}\n                                width={30}\n                                style={{ objectFit: \"cover\", objectPosition: \"center\" }}\n                              />\n                            }\n                            right={\n                              <span className=\"hide-menu font-14\">\n                                {enrollee.nickname}\n                              </span>\n                            }\n                            key={enrollee.nickname}\n                          />\n                        ))}\n                      </div>\n                    </div>\n                  )}\n                </div>\n                <div className=\"checkout__order-details__detail__description\">\n                  <div className=\"checkout__order-details__detail__description__price col\">\n                    <div className=\"checkout__order-details__detail__description__price--after-discount text-monospace\">\n                      {toMoneyFormat(item.price, currency)}\n                      <span className=\"text-black-50\">\n                        ({item.enrollees ? item.enrollees.length : 1}x)\n                      </span>\n                    </div>\n                    {/* <div className=\"checkout__order-details__detail__description__price--before-discount\">\n                        {classDetails.price}\n                      </div> */}\n                  </div>\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n\n        {!discountCode.data && _.round(total, 2) > 0 && ( // Show discountCode input only if none is applied\n          <div className=\"discount-code d-flex align-items-center\">\n            <InputControl\n              name=\"notValidated_discountCode\"\n              label=\"\"\n              type=\"text\"\n              placeholder=\"Discount Code\"\n              disabled={discountCode.loading}\n            />\n            <button\n              className=\"btn btn-outline-info w-auto ml-2 text-uppercase\"\n              onClick={handleClickApplyDiscountCode}\n            >\n              {discountCode.loading ? (\n                <div>\n                  <div\n                    class=\"spinner-border text-primary mr-2\"\n                    role=\"status\"\n                    style={{ width: 20, height: 20 }}\n                  >\n                    <span class=\"sr-only\">Loading...</span>\n                  </div>\n                  Validating\n                </div>\n              ) : (\n                <div style={{ width: 118.76 }}>Apply</div>\n              )}\n            </button>\n          </div>\n        )}\n\n        {discountCode.data && (\n          <div>\n            <label className=\"font-bold mb-3\">Discount Code</label>\n            <div>\n              <span\n                style={{\n                  border: \"1px solid\",\n                  padding: 9,\n                  borderRadius: 8,\n                  fontSize: 17,\n                  fontWeight: 700,\n                  color: \"#1875d2\",\n                }}\n              >\n                {discountCode.data.code}\n                <i\n                  className=\"ml-2 fa fa-times text-dark\"\n                  style={{ opacity: 0.7, cursor: \"pointer\" }}\n                  onClick={handleClickRemoveDiscountCode}\n                ></i>\n              </span>\n            </div>\n          </div>\n        )}\n        <div className=\"checkout__billing\">\n          <div className=\"checkout__billing__billing-address-input\">\n            <label className=\"font-bold\">Billing Address</label>\n            <div style={{ display: \"grid\", rowGap: 30 }}>\n              <InputControl\n                type=\"text\"\n                name=\"streetAddress\"\n                label=\"Street Address\"\n                placeholder=\" \"\n              />\n              <InputControl\n                type=\"text\"\n                name=\"streetAddress2\"\n                label=\"Street Address Line 2\"\n                placeholder=\" \"\n              />\n              <div style={{ display: \"grid\", rowGap: 30 }}>\n                <div\n                  style={{\n                    display: \"grid\",\n                    gridTemplateColumns: \"repeat(auto-fill, minmax(200px, 1fr))\",\n                    columnGap: 10,\n                  }}\n                >\n                  <FormSpy subscription={{ values: true }}>\n                    {(props) =>\n                      // Solution for incomplete city data: allow user to input city manually\n                      (props.values.country &&\n                        props.values.state &&\n                        (CITY.getCitiesOfState(props.values.country, props.values.state)\n                          .length ? (\n                          <SelectControl\n                            label={\"City\"}\n                            name=\"city\"\n                            options={CITY.getCitiesOfState(\n                              props.values.country,\n                              props.values.state\n                            ).map(({ name: label }) => ({\n                              label: `${label}`,\n                              value: label,\n                            }))}\n                          />\n                        ) : (\n                          <InputControl\n                            type=\"text\"\n                            name=\"city\"\n                            label=\"City\"\n                            placeholder=\" \"\n                          />\n                        ))) || <div />\n                    }\n                  </FormSpy>\n                  <FormSpy subscription={{ values: true }}>\n                    {(props) => (\n                      <SelectControl\n                        label=\"State\"\n                        name=\"state\"\n                        options={getStatesOfCountry(props.values.country).map(\n                          ({ name: label, isoCode: value, flag: emoji }) => ({\n                            label: `${label} ${emoji ? emoji : \"\"}`,\n                            value,\n                          })\n                        )}\n                      />\n                    )}\n                  </FormSpy>\n                </div>\n                <div\n                  style={{\n                    display: \"grid\",\n                    gridTemplateColumns: \"repeat(auto-fill, minmax(200px, 1fr))\",\n                    columnGap: 10,\n                  }}\n                >\n                  <InputControl\n                    type=\"text\"\n                    name=\"postalCode\"\n                    label=\"Postal Code\"\n                    placeholder=\" \"\n                  />\n                  <SelectControl\n                    label=\"Country\"\n                    name=\"country\"\n                    options={Country.getAllCountries().map(\n                      ({ name: label, isoCode: value, flag: emoji }) => ({\n                        label: `${label} ${emoji ? emoji : \"\"}`,\n                        value,\n                      })\n                    )}\n                  />\n                </div>\n              </div>\n            </div>\n            <div className=\"mt-5\">\n              <label className=\"font-bold\">Email Address</label>\n              <InputControl type=\"text\" name=\"email\" label=\"\" placeholder=\" \" />\n            </div>\n          </div>\n          <br />\n          {/* {parseInt(total) !== 0 && ( */}\n          {false && (\n            <div className=\"checkout__billing__payment-mode mt-4\">\n              <label className=\"font-bold\">Payment Method</label>\n              <div\n                className=\"text-center data-loading\"\n                style={{ display: loading ? \"block\" : \"none\", width: \"38rem\" }}\n              >\n                <div className=\"spinner-border text-primary\" role=\"status\">\n                  <span className=\"sr-only\">Loading...</span>\n                </div>\n                <div className=\"loading-text\">Loading Payment Methods ...</div>\n              </div>\n              <div\n                className=\"text-center\"\n                style={{\n                  display:\n                    !loading && Object.keys(processors).length < 1 ? \"block\" : \"none\",\n                  width: \"38rem\",\n                }}\n              >\n                <div className=\"no-data error\">\n                  There was an error loading the Payment Methods. Please try refreshing\n                  the page.\n                </div>\n              </div>\n              {submitFailed && <Error name=\"procId\" />}\n              {processors && (\n                <FormSpy subscription={{ values: true }}>\n                  {(props) => (\n                    <div\n                      style={{\n                        height: \"5rem\",\n                        position: \"relative\",\n                      }}\n                    >\n                      <AnimatePresence exitBeforeEnter>\n                        {(!props.values.procId && (\n                          <motion.div\n                            key=\"toppaymentmethods-container\"\n                            initial={{ opacity: 0 }}\n                            animate={{ opacity: 1 }}\n                            // transition={{ duration: 0.1 }}\n                            exit={{ opacity: 0 }}\n                            style={{\n                              display: \"grid\",\n                              gridTemplateColumns: \"repeat(auto-fill, minmax(8rem, 1fr))\",\n                              gap: 10,\n                              width: \"100%\",\n                            }}\n                          >\n                            <TopPaymentMethod\n                              paymentMethod={getPaymentMethodByProcId(\n                                CHECKOUT_PAGE_TOP_PAYMENT_METHODS[0],\n                                processors\n                              )}\n                            />\n                            <TopPaymentMethod\n                              paymentMethod={getPaymentMethodByProcId(\n                                CHECKOUT_PAGE_TOP_PAYMENT_METHODS[1],\n                                processors\n                              )}\n                            />\n                            <TopPaymentMethod\n                              paymentMethod={getPaymentMethodByProcId(\n                                CHECKOUT_PAGE_TOP_PAYMENT_METHODS[2],\n                                processors\n                              )}\n                            />\n                            <PaymentMethodSelectorModal\n                              trigger={\n                                <OtherPaymentMethods\n                                  paymentMethod={{\n                                    name: \"Other payment methods\",\n                                    procId: \"others\",\n                                    logo: \"img/ellipsis-logo.png\",\n                                  }}\n                                  onClick={handleClickOtherPaymentMethods}\n                                />\n                              }\n                              subTotal={subTotal}\n                            />\n                          </motion.div>\n                        )) || (\n                          <motion.div\n                            initial={{ opacity: 0 }}\n                            animate={{ opacity: 1 }}\n                            exit={{ opacity: 0 }}\n                            key=\"selectedpaymentmethod\"\n                            style={{\n                              position: \"absolute\",\n                            }}\n                          >\n                            <SelectedPaymentMethod\n                              method={getPaymentMethodByProcId(\n                                props.values.procId,\n                                processors\n                              )}\n                              handleClickPaymentMethod={handleClickPaymentMethod}\n                            />\n                          </motion.div>\n                        )}\n                      </AnimatePresence>\n                    </div>\n                  )}\n                </FormSpy>\n              )}\n              {false &&\n                !loading &&\n                Object.keys(processors).map((mode, index) => (\n                  <div className=\"accordion\" id=\"accordionExample\">\n                    <div className=\"card\">\n                      <div\n                        className=\"card-header\"\n                        id={`heading${index}`}\n                        role=\"button\"\n                        type=\"button\"\n                        onClick={() => expandMode(index)}\n                        data-toggle=\"collapse\"\n                        data-target={`#collapse${index}`}\n                        aria-expanded=\"false\"\n                        aria-controls={`collapse${index}`}\n                      >\n                        <div className=\"container\">\n                          <div className=\"row justify-content-between\">\n                            <div>\n                              <button\n                                className=\"btn btn-link\"\n                                data-toggle=\"collapse\"\n                                data-target={`#collapse${index}`}\n                                aria-expanded=\"false\"\n                                aria-controls={`collapse${index}`}\n                                type=\"button\"\n                              >\n                                {mode}\n                              </button>\n                            </div>\n                            <div>\n                              {paymentMode !== index && (\n                                <button\n                                  className=\"btn btn-link\"\n                                  data-toggle=\"collapse\"\n                                  data-target={`#collapse${index}`}\n                                  aria-expanded=\"false\"\n                                  aria-controls={`collapse${index}`}\n                                  type=\"button\"\n                                >\n                                  <i className=\"fas fa-chevron-right\"></i>\n                                </button>\n                              )}\n                              {paymentMode === index && (\n                                <button\n                                  className=\"btn btn-link\"\n                                  data-toggle=\"collapse\"\n                                  data-target={`#collapse${index}`}\n                                  aria-expanded=\"false\"\n                                  aria-controls={`collapse${index}`}\n                                  type=\"button\"\n                                >\n                                  <i className=\"fas fa-chevron-down\"></i>\n                                </button>\n                              )}\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n\n                      <div\n                        id={`collapse${index}`}\n                        className=\"collapse\"\n                        aria-labelledby={`heading${index}`}\n                        data-parent=\"#accordionExample\"\n                      >\n                        <div className=\"card-body\">\n                          <ul class=\"list-group list-group-flush\">ww</ul>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n            </div>\n          )}\n        </div>\n      </div>\n      <div className=\"right\">\n        <div className=\"checkout__summary\">\n          <div className=\"custom-black-secondary-text\">Summary</div>\n          <div className=\"checkout__summary__price\">\n            <div>Subtotal:</div>\n            <div className=\"text-monospace\">{toMoneyFormat(subTotal,currency)}</div>\n          </div>\n          <div className=\"checkout__summary__price\">\n            <div>Coupon Discounts:</div>\n            <div className=\"text-monospace\">\n              {cashDiscount > 0 ? \"-\" + toMoneyFormat(cashDiscount, currency) : \"\"}\n            </div>\n          </div>\n          <hr className=\"border-dark\" />\n          <div className=\"checkout__summary__price font-weight-bold\">\n            <div>Total:</div>\n            <div className=\"font-20\">{toMoneyFormat(total, currency)}</div>\n          </div>\n          <div className=\"font-14 mb-2\">\n            <p>\n              Tagpros is required by law to collect applicable transaction taxes for\n              purchases made in certain tax jurisdictions.\n            </p>\n            <p>\n              By completing your purchase you agree to these{\" \"}\n              <span className=\"text-info font-bold\">Terms of Service</span>.\n            </p>\n          </div>\n          {_.round(total, 2) === 0 && <button\n            className=\"py-2 w-100 text-white btn btn-info mt-4\"\n            type=\"submit\"\n            disabled={pristine || (hasValidationErrors && !dirtySinceLastSubmit)}\n          >\n            Proceed\n          </button>}\n          {_.round(total, 2) > 0 && <div>\n            <button \n              type=\"button\" \n              className=\"btn btn-outline-info btn-block mb-3\" \n              data-toggle=\"tooltip\" \n              title=\"Instructions will be given on deposit procedure\"\n              // disabled={hasValidationErrors}\n              onClick={() => {setShowModal(true)}}\n            >\n              <i className=\"fas fa-university mr-1\"></i> <b>Bank Transfer/Deposit</b>\n            </button>\n            <PayPalScriptProvider\n                options={{\n                    \"client-id\": paypalConfig.clientId,\n                    components: \"buttons\",\n                    currency: currency\n                }}>\n              <ButtonWrapper\n                    hasError={hasValidationErrors}\n                    total={total}\n                    discount={cashDiscount}\n                    currency={currency}\n                    showSpinner={false}\n                    onCreateOrder={createOrder}\n                    onApprove={onApprove}\n                    onCancel={onCancel}\n                    onError={onError}\n                />\n            </PayPalScriptProvider>\n          </div>}\n        </div>\n      </div>\n      <Modal\n        size='lg'\n        show={showModal}\n        backdrop='static'\n        keyboard={false}\n      >\n        <Modal.Header>\n          <Modal.Title>Bank Transfer/Deposit Details</Modal.Title>\n        </Modal.Header>\n        <Modal.Body className=\"bank-details\">\n          <p>Clicking proceed will add class/es included in this checkout to your <b>Pending Enrollments</b>. \n            Enrollment will be considered final once we confirm receipt of the payment.\n            You will receive an invoice with complete payment instructions in your tagpros registered email address.\n          </p>\n          <p>Please take note of the bank details below.</p>\n          <table class=\"table table-bordered table-striped\">\n            <tbody>\n              <tr>\n                <td className=\"text-uppercase\"><b>Bank Name: </b></td>\n                <td>Bank of the Philippine Islands </td>\n              </tr>\n              <tr>\n                <td className=\"text-uppercase\"><b>Account Name: </b></td>\n                <td>Tagpros Education OPC</td>\n              </tr>\n              <tr>\n                <td className=\"text-uppercase\"><b>Account Number</b></td>\n                <td></td>\n              </tr>\n              <tr>\n                <td className=\"pl-5\"><b>Dollar Account: </b></td>\n                <td>002024-5256-89</td>\n              </tr>\n              <tr>\n                <td className=\"pl-5\"><b>Peso Account: </b></td>\n                <td>002021-5053-26</td>\n              </tr>\n            </tbody>\n          </table>\n\n          <p><i></i></p>\n        </Modal.Body>\n        <Modal.Footer>\n          <Button variant='primary' onClick={() => processPayment(\"OTC\")} disabled={loadingPayment}>\n            <span\n              style={{ display: loadingPayment ? 'inline-block' : 'none' }}\n              class='spinner-border spinner-border-sm btn-load'\n              role='status'\n              aria-hidden='true'\n              />\n            Proceed\n          </Button>\n          <Button variant='secondary' onClick={() => setShowModal(false)}>\n            Cancel\n          </Button>\n        </Modal.Footer>\n      </Modal>\n    </div>\n  );\n};\n\nconst ButtonWrapper = ({ total, cashDiscount, currency, showSpinner, hasError, onCreateOrder, onApprove, onCancel, onError }) => {\n    // usePayPalScriptReducer can be use only inside children of PayPalScriptProviders\n    // This is the main reason to wrap the PayPalButtons in a new component\n    const [{ options, isPending }, dispatch] = usePayPalScriptReducer();\n\n    useEffect(() => {\n        dispatch({\n            type: \"resetOptions\",\n            value: {\n                ...options,\n                currency: currency,\n            },\n        });\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [currency, showSpinner]);\n\n\n    return (<>\n            { (showSpinner && isPending) && <span className=\"spinner-border spinner-border-sm btn-load\" role=\"status\" aria-hidden=\"true\"></span> }\n            <PayPalButtons\n                style={{color:'blue', label: 'buynow'}}\n                disabled={hasError}\n                forceReRender={[total, currency, cashDiscount]}\n                fundingSource={undefined}\n                disableFunding={\"credit\"}\n                createOrder={(data, actions) => onCreateOrder(data, actions)}\n                onApprove={(data, actions) => onApprove(data, actions)}\n                onCancel={(data, actions) => onCancel(data, actions)}\n                onError={(data, actions) => onError(data, actions)}\n            />\n        </>\n    );\n}\n\nexport default function CheckoutPage() {\n  // const [classDetails, setclassDetails] = useState({});\n  const navigate = useNavigate();\n  const location = useLocation();\n  const dispatch = useDispatch();\n  const processors = useSelector((state) =>\n    state.payment ? state.payment.getIn([\"data\", \"processors\"]) : []\n  );\n  // const { enrollmentId } = useSelector((state) =>\n  //   state.classes.get(\"enroll\") ? state.classes.get(\"enroll\") : {}\n  // );\n  const user = useSelector((state) => (state.auth.user ? state.auth.user : {}));\n  const userAuth = useSelector(state => state.auth);\n\n  const searchParams = {\n    learners: location.state?.learners,\n    classId: location.state?.classId,\n    enrollmentId: location.state?.enrollmentId,\n    classes: location.state?.classes,\n  };\n\n  const fetchData = async () => {\n    getProcessors(dispatch);\n  };\n  const getEnrollees = (enrollees) => \n    userAuth.accountType === 'learner' ? [{ ...userAuth.user }] : enrollees \n  const submit = (values) => {\n    // const redirectUrl =\n    //   \"/order-summary?txnid=txn00011&refno=PLB697I1&status=S&message=%5b000%5d+BOG+Reference+No%3a+20211102181838+%23PLB697I1&digest=855d20e8a8e422b6878b3352af5fd61b07ed3c6f\";\n    const classParam = searchParams.classes.map(({classId, enrollees, cartId}) => {\n      return {classId, enrollees: getEnrollees(enrollees), cartId};\n    });\n    api\n      .post(`/payment/${user.type}`, {\n        ...values,\n        classes: classParam,\n      })\n      .then((response) => {\n        if (response.data.free === true) {\n          const redirectUrl = new URL(`${window.location.origin}/order-summary`);\n          redirectUrl.searchParams.append(\"txnid\", response.data.txnId);\n          redirectUrl.searchParams.append(\"refno\", response.data.txnId);\n          redirectUrl.searchParams.append(\"status\", \"S\");\n          redirectUrl.searchParams.append(\"message\", \"Free Enrollment\");\n          redirectUrl.searchParams.append(\"param1\", response.data.param1);\n          window.location.replace(redirectUrl.href);\n        } else {\n          window.location.replace(response.data.Url);\n        }\n      })\n      .catch((error) => {\n        toast.error(\"Failed to connect with payment. Please try again later.\");\n        console.log(error);\n      });\n    // navigate(redirectUrl);\n  };\n\n  // const isInvalidVisit = () =>\n  //   (user.type === \"family\" && searchParams[\"classes\"]) ||\n  //   (user.type === \"learner\" && searchParams[\"classes\"]);\n  useEffect(() => {\n    if (!user || !searchParams[\"classes\"]) navigate(\"/\", { replace: true });\n    fetchData();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const validate = useValidationSchema(checkoutValidator);\n\n  return (\n    <Form\n      onSubmit={submit}\n      validate={validate}\n      initialValues={{\n        procId: \"PYPL\",\n        email: user?.email,\n        country: \"PH\",\n        state: \"ABR\",\n        city: \"Adams\",\n      }}\n      render={({ handleSubmit }) => (\n        <form className=\"wrapper radio-input-fix\" onSubmit={handleSubmit}>\n          <div className=\"header\">\n            <Header />\n          </div>\n          <div className=\"content\">\n            {/* {isSearchParamsComplete() ? <CheckoutPaymentResponse /> : <CheckoutForm />} */}\n            <CheckoutForm\n              processors={processors}\n              enrollees={searchParams.learners}\n              classes={searchParams.classes}\n              userType={user.type}\n            />\n          </div>\n        </form>\n      )}\n    />\n  );\n}\n"]},"metadata":{},"sourceType":"module"}