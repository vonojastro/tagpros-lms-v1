{"ast":null,"code":"import { __assign, __extends, __rest } from \"tslib\";\nimport { createContext, PureComponent } from 'react';\nimport * as React from 'react';\nimport ContentEditable from './ContentEditable';\nimport defaultStyles from './styles';\nimport { deepMerge, getSelectedNode } from './utils';\nexport var EditorContext = createContext({\n  styles: defaultStyles\n});\n\nvar Editor =\n/** @class */\nfunction (_super) {\n  __extends(Editor, _super);\n\n  function Editor(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.state = {};\n    _this.onClickOutside = _this.onClickOutside.bind(_this);\n    _this.onTextSelect = _this.onTextSelect.bind(_this);\n    _this.setContentEditableRef = _this.setContentEditableRef.bind(_this);\n    return _this;\n  }\n\n  Editor.prototype.componentDidMount = function () {\n    document.addEventListener('click', this.onClickOutside);\n  };\n\n  Editor.prototype.componentWillUnmount = function () {\n    document.removeEventListener('click', this.onClickOutside);\n  };\n\n  Editor.prototype.onClickOutside = function (event) {\n    var contentEditable = this.state.contentEditable;\n\n    if (event.target === contentEditable) {\n      return;\n    }\n\n    if (contentEditable && contentEditable.contains(event.target)) {\n      return;\n    }\n\n    this.setState({\n      selection: null\n    });\n  };\n\n  Editor.prototype.onTextSelect = function (e) {\n    this.props.onSelect && this.props.onSelect(e);\n    this.setState({\n      selection: getSelectedNode()\n    });\n  };\n\n  Editor.prototype.setContentEditableRef = function (el) {\n    this.setState({\n      contentEditable: el\n    });\n    this.props.contentEditableRef && this.props.contentEditableRef(el);\n  };\n\n  Editor.prototype.render = function () {\n    var _a = this.props,\n        children = _a.children,\n        styles = _a.styles,\n        props = __rest(_a, [\"children\", \"styles\"]);\n\n    var _b = this.state,\n        contentEditable = _b.contentEditable,\n        selection = _b.selection;\n    var allStyles = deepMerge({}, defaultStyles, styles);\n    var context = {\n      el: contentEditable,\n      selection: selection,\n      styles: allStyles\n    };\n    return React.createElement(\"div\", {\n      style: context.styles.editor\n    }, React.createElement(EditorContext.Provider, {\n      value: context\n    }, children, React.createElement(ContentEditable, __assign({}, props, {\n      contentEditableRef: this.setContentEditableRef,\n      onSelect: this.onTextSelect,\n      style: allStyles.contentEditable\n    }))));\n  };\n\n  return Editor;\n}(PureComponent);\n\nexport default Editor;\nexport function withEditorContext(Component) {\n  var childName = Component.displayName || Component.name;\n  WithEditorContext.displayName = \"withEditorContext(\" + childName + \")\";\n  return WithEditorContext;\n\n  function WithEditorContext(props) {\n    return React.createElement(EditorContext.Consumer, null, function (context) {\n      return React.createElement(Component, __assign({}, props, {\n        el: context.el,\n        selection: context.selection,\n        styles: context.styles\n      }));\n    });\n  }\n}","map":{"version":3,"sources":["../../src/Editor.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { __assign, __extends, __rest } from \"tslib\";\nimport { createContext, PureComponent, } from 'react';\nimport * as React from 'react';\nimport ContentEditable from './ContentEditable';\nimport defaultStyles from './styles';\nimport { deepMerge, getSelectedNode } from './utils';\nexport var EditorContext = createContext({\n    styles: defaultStyles,\n});\nvar Editor = /** @class */ (function (_super) {\n    __extends(Editor, _super);\n    function Editor(props) {\n        var _this = _super.call(this, props) || this;\n        _this.state = {};\n        _this.onClickOutside = _this.onClickOutside.bind(_this);\n        _this.onTextSelect = _this.onTextSelect.bind(_this);\n        _this.setContentEditableRef = _this.setContentEditableRef.bind(_this);\n        return _this;\n    }\n    Editor.prototype.componentDidMount = function () {\n        document.addEventListener('click', this.onClickOutside);\n    };\n    Editor.prototype.componentWillUnmount = function () {\n        document.removeEventListener('click', this.onClickOutside);\n    };\n    Editor.prototype.onClickOutside = function (event) {\n        var contentEditable = this.state.contentEditable;\n        if (event.target === contentEditable) {\n            return;\n        }\n        if (contentEditable && contentEditable.contains(event.target)) {\n            return;\n        }\n        this.setState({ selection: null });\n    };\n    Editor.prototype.onTextSelect = function (e) {\n        this.props.onSelect && this.props.onSelect(e);\n        this.setState({ selection: getSelectedNode() });\n    };\n    Editor.prototype.setContentEditableRef = function (el) {\n        this.setState({ contentEditable: el });\n        this.props.contentEditableRef && this.props.contentEditableRef(el);\n    };\n    Editor.prototype.render = function () {\n        var _a = this.props, children = _a.children, styles = _a.styles, props = __rest(_a, [\"children\", \"styles\"]);\n        var _b = this.state, contentEditable = _b.contentEditable, selection = _b.selection;\n        var allStyles = deepMerge({}, defaultStyles, styles);\n        var context = {\n            el: contentEditable,\n            selection: selection,\n            styles: allStyles,\n        };\n        return (React.createElement(\"div\", { style: context.styles.editor },\n            React.createElement(EditorContext.Provider, { value: context },\n                children,\n                React.createElement(ContentEditable, __assign({}, props, { contentEditableRef: this.setContentEditableRef, onSelect: this.onTextSelect, style: allStyles.contentEditable })))));\n    };\n    return Editor;\n}(PureComponent));\nexport default Editor;\nexport function withEditorContext(Component) {\n    var childName = Component.displayName || Component.name;\n    WithEditorContext.displayName = \"withEditorContext(\" + childName + \")\";\n    return WithEditorContext;\n    function WithEditorContext(props) {\n        return (React.createElement(EditorContext.Consumer, null, function (context) { return (React.createElement(Component, __assign({}, props, { el: context.el, selection: context.selection, styles: context.styles }))); }));\n    }\n}\n//# sourceMappingURL=Editor.js.map"]},"metadata":{},"sourceType":"module"}