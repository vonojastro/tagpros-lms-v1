{"ast":null,"code":"import { useMemo, useState, useEffect, useCallback, useRef } from \"react\"; // Gets value from localstorage\n\nfunction getValueFromLocalStorage(key) {\n  var _a;\n\n  if (typeof localStorage === \"undefined\") {\n    return null;\n  }\n\n  var storedValue = (_a = localStorage.getItem(key)) !== null && _a !== void 0 ? _a : \"null\";\n\n  try {\n    return JSON.parse(storedValue);\n  } catch (error) {\n    console.error(error);\n  }\n\n  return storedValue;\n} // Saves value to localstorage\n\n\nfunction saveValueToLocalStorage(key, value) {\n  if (typeof localStorage === \"undefined\") {\n    return null;\n  }\n\n  return localStorage.setItem(key, JSON.stringify(value));\n}\n/**\n * @param key Key of the localStorage object\n * @param initialState Default initial value\n */\n\n\nfunction initialize(key, initialState) {\n  var valueLoadedFromLocalStorage = getValueFromLocalStorage(key);\n\n  if (valueLoadedFromLocalStorage === null) {\n    return initialState;\n  } else {\n    return valueLoadedFromLocalStorage;\n  }\n}\n/**\n * useLocalstorageState hook\n * Tracks a value within localStorage and updates it\n *\n * @param {string} key - Key of the localStorage object\n * @param {any} initialState - Default initial value\n */\n\n\nfunction useLocalstorageState(key, initialState) {\n  var _a = useState(function () {\n    return initialize(key, initialState);\n  }),\n      value = _a[0],\n      setValue = _a[1];\n\n  var isUpdateFromCrossDocumentListener = useRef(false);\n  var isUpdateFromWithinDocumentListener = useRef(false);\n  var customEventTypeName = useMemo(function () {\n    return \"rooks-\".concat(key, \"-localstorage-update\");\n  }, [key]);\n  useEffect(function () {\n    /**\n     * We need to ensure there is no loop of\n     * storage events fired. Hence we are using a ref\n     * to keep track of whether setValue is from another\n     * storage event\n     */\n    if (!isUpdateFromCrossDocumentListener.current || !isUpdateFromWithinDocumentListener.current) {\n      saveValueToLocalStorage(key, value);\n    }\n  }, [key, value]);\n  var listenToCrossDocumentStorageEvents = useCallback(function (event) {\n    var _a;\n\n    if (event.storageArea === localStorage && event.key === key) {\n      try {\n        isUpdateFromCrossDocumentListener.current = true;\n        var newValue = JSON.parse((_a = event.newValue) !== null && _a !== void 0 ? _a : \"null\");\n\n        if (value !== newValue) {\n          setValue(newValue);\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    }\n  }, [key, value]); // check for changes across documents\n\n  useEffect(function () {\n    // eslint-disable-next-line no-negated-condition\n    if (typeof window !== \"undefined\") {\n      window.addEventListener(\"storage\", listenToCrossDocumentStorageEvents);\n      return function () {\n        window.removeEventListener(\"storage\", listenToCrossDocumentStorageEvents);\n      };\n    } else {\n      console.warn(\"useLocalstorageState: window is undefined.\");\n      return function () {};\n    }\n  }, [listenToCrossDocumentStorageEvents]);\n  var listenToCustomEventWithinDocument = useCallback(function (event) {\n    try {\n      isUpdateFromWithinDocumentListener.current = true;\n      var newValue = event.detail.newValue;\n\n      if (value !== newValue) {\n        setValue(newValue);\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  }, [value]); // check for changes within document\n\n  useEffect(function () {\n    // eslint-disable-next-line no-negated-condition\n    if (typeof document !== \"undefined\") {\n      document.addEventListener(customEventTypeName, listenToCustomEventWithinDocument);\n      return function () {\n        document.removeEventListener(customEventTypeName, listenToCustomEventWithinDocument);\n      };\n    } else {\n      console.warn(\"[useLocalstorageState] document is undefined.\");\n      return function () {};\n    }\n  }, [customEventTypeName, listenToCustomEventWithinDocument]);\n  var broadcastValueWithinDocument = useCallback(function (newValue) {\n    // eslint-disable-next-line no-negated-condition\n    if (typeof document !== \"undefined\") {\n      var event_1 = new CustomEvent(customEventTypeName, {\n        detail: {\n          newValue: newValue\n        }\n      });\n      document.dispatchEvent(event_1);\n    } else {\n      console.warn(\"[useLocalstorageState] document is undefined.\");\n    }\n  }, [customEventTypeName]);\n  var set = useCallback(function (newValue) {\n    isUpdateFromCrossDocumentListener.current = false;\n    isUpdateFromWithinDocumentListener.current = false;\n    setValue(newValue);\n    broadcastValueWithinDocument(newValue);\n  }, [broadcastValueWithinDocument]);\n  var remove = useCallback(function () {\n    localStorage.removeItem(key);\n  }, [key]);\n  return [value, set, remove];\n}\n\nexport { useLocalstorageState };","map":{"version":3,"sources":["/Users/vonojastro/Desktop/lms-frontend-v2/node_modules/rooks/dist/esm/hooks/useLocalstorageState.js"],"names":["useMemo","useState","useEffect","useCallback","useRef","getValueFromLocalStorage","key","_a","localStorage","storedValue","getItem","JSON","parse","error","console","saveValueToLocalStorage","value","setItem","stringify","initialize","initialState","valueLoadedFromLocalStorage","useLocalstorageState","setValue","isUpdateFromCrossDocumentListener","isUpdateFromWithinDocumentListener","customEventTypeName","concat","current","listenToCrossDocumentStorageEvents","event","storageArea","newValue","log","window","addEventListener","removeEventListener","warn","listenToCustomEventWithinDocument","detail","document","broadcastValueWithinDocument","event_1","CustomEvent","dispatchEvent","set","remove","removeItem"],"mappings":"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","sourcesContent":["import { useMemo, useState, useEffect, useCallback, useRef } from \"react\";\n// Gets value from localstorage\nfunction getValueFromLocalStorage(key) {\n    var _a;\n    if (typeof localStorage === \"undefined\") {\n        return null;\n    }\n    var storedValue = (_a = localStorage.getItem(key)) !== null && _a !== void 0 ? _a : \"null\";\n    try {\n        return JSON.parse(storedValue);\n    }\n    catch (error) {\n        console.error(error);\n    }\n    return storedValue;\n}\n// Saves value to localstorage\nfunction saveValueToLocalStorage(key, value) {\n    if (typeof localStorage === \"undefined\") {\n        return null;\n    }\n    return localStorage.setItem(key, JSON.stringify(value));\n}\n/**\n * @param key Key of the localStorage object\n * @param initialState Default initial value\n */\nfunction initialize(key, initialState) {\n    var valueLoadedFromLocalStorage = getValueFromLocalStorage(key);\n    if (valueLoadedFromLocalStorage === null) {\n        return initialState;\n    }\n    else {\n        return valueLoadedFromLocalStorage;\n    }\n}\n/**\n * useLocalstorageState hook\n * Tracks a value within localStorage and updates it\n *\n * @param {string} key - Key of the localStorage object\n * @param {any} initialState - Default initial value\n */\nfunction useLocalstorageState(key, initialState) {\n    var _a = useState(function () { return initialize(key, initialState); }), value = _a[0], setValue = _a[1];\n    var isUpdateFromCrossDocumentListener = useRef(false);\n    var isUpdateFromWithinDocumentListener = useRef(false);\n    var customEventTypeName = useMemo(function () {\n        return \"rooks-\".concat(key, \"-localstorage-update\");\n    }, [key]);\n    useEffect(function () {\n        /**\n         * We need to ensure there is no loop of\n         * storage events fired. Hence we are using a ref\n         * to keep track of whether setValue is from another\n         * storage event\n         */\n        if (!isUpdateFromCrossDocumentListener.current ||\n            !isUpdateFromWithinDocumentListener.current) {\n            saveValueToLocalStorage(key, value);\n        }\n    }, [key, value]);\n    var listenToCrossDocumentStorageEvents = useCallback(function (event) {\n        var _a;\n        if (event.storageArea === localStorage && event.key === key) {\n            try {\n                isUpdateFromCrossDocumentListener.current = true;\n                var newValue = JSON.parse((_a = event.newValue) !== null && _a !== void 0 ? _a : \"null\");\n                if (value !== newValue) {\n                    setValue(newValue);\n                }\n            }\n            catch (error) {\n                console.log(error);\n            }\n        }\n    }, [key, value]);\n    // check for changes across documents\n    useEffect(function () {\n        // eslint-disable-next-line no-negated-condition\n        if (typeof window !== \"undefined\") {\n            window.addEventListener(\"storage\", listenToCrossDocumentStorageEvents);\n            return function () {\n                window.removeEventListener(\"storage\", listenToCrossDocumentStorageEvents);\n            };\n        }\n        else {\n            console.warn(\"useLocalstorageState: window is undefined.\");\n            return function () { };\n        }\n    }, [listenToCrossDocumentStorageEvents]);\n    var listenToCustomEventWithinDocument = useCallback(function (event) {\n        try {\n            isUpdateFromWithinDocumentListener.current = true;\n            var newValue = event.detail.newValue;\n            if (value !== newValue) {\n                setValue(newValue);\n            }\n        }\n        catch (error) {\n            console.log(error);\n        }\n    }, [value]);\n    // check for changes within document\n    useEffect(function () {\n        // eslint-disable-next-line no-negated-condition\n        if (typeof document !== \"undefined\") {\n            document.addEventListener(customEventTypeName, listenToCustomEventWithinDocument);\n            return function () {\n                document.removeEventListener(customEventTypeName, listenToCustomEventWithinDocument);\n            };\n        }\n        else {\n            console.warn(\"[useLocalstorageState] document is undefined.\");\n            return function () { };\n        }\n    }, [customEventTypeName, listenToCustomEventWithinDocument]);\n    var broadcastValueWithinDocument = useCallback(function (newValue) {\n        // eslint-disable-next-line no-negated-condition\n        if (typeof document !== \"undefined\") {\n            var event_1 = new CustomEvent(customEventTypeName, { detail: { newValue: newValue } });\n            document.dispatchEvent(event_1);\n        }\n        else {\n            console.warn(\"[useLocalstorageState] document is undefined.\");\n        }\n    }, [customEventTypeName]);\n    var set = useCallback(function (newValue) {\n        isUpdateFromCrossDocumentListener.current = false;\n        isUpdateFromWithinDocumentListener.current = false;\n        setValue(newValue);\n        broadcastValueWithinDocument(newValue);\n    }, [broadcastValueWithinDocument]);\n    var remove = useCallback(function () {\n        localStorage.removeItem(key);\n    }, [key]);\n    return [value, set, remove];\n}\nexport { useLocalstorageState };\n"]},"metadata":{},"sourceType":"module"}