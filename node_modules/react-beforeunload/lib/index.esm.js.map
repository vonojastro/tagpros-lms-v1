{"version":3,"file":"index.esm.js","sources":["../src/useBeforeunload.js","../src/Beforeunload.js"],"sourcesContent":["import { useEffect, useRef } from 'react';\nimport invariant from 'tiny-invariant';\n\nconst useBeforeunload = (handler) => {\n  invariant(\n    handler == null || typeof handler === 'function',\n    'Expected `handler` to be a function'\n  );\n\n  const eventListenerRef = useRef();\n\n  useEffect(() => {\n    eventListenerRef.current = (event) => {\n      const returnValue = handler?.(event);\n      // Handle legacy `event.returnValue` property\n      // https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeunload_event\n      if (typeof returnValue === 'string') {\n        return (event.returnValue = returnValue);\n      }\n      // Chrome doesn't support `event.preventDefault()` on `BeforeUnloadEvent`,\n      // instead it requires `event.returnValue` to be set\n      // https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers/onbeforeunload#browser_compatibility\n      if (event.defaultPrevented) {\n        return (event.returnValue = '');\n      }\n    };\n  }, [handler]);\n\n  useEffect(() => {\n    const eventListener = (event) => eventListenerRef.current(event);\n    window.addEventListener('beforeunload', eventListener);\n    return () => {\n      window.removeEventListener('beforeunload', eventListener);\n    };\n  }, []);\n};\n\nexport default useBeforeunload;\n","import PropTypes from 'prop-types';\nimport useBeforeunload from './useBeforeunload';\n\nconst Beforeunload = ({ children = null, onBeforeunload }) => {\n  useBeforeunload(onBeforeunload);\n  return children;\n};\n\nBeforeunload.propTypes /* remove-proptypes */ = {\n  children: PropTypes.any,\n  onBeforeunload: PropTypes.func.isRequired,\n};\n\nexport default Beforeunload;\n"],"names":["useBeforeunload","handler","invariant","eventListenerRef","useRef","useEffect","current","event","returnValue","defaultPrevented","eventListener","window","addEventListener","removeEventListener","Beforeunload","children","onBeforeunload","propTypes","PropTypes","any","func","isRequired"],"mappings":";;;;IAGMA,eAAe,GAAG,SAAlBA,eAAkB,CAACC,OAAD,EAAa;AACnC,IACEA,OAAO,IAAI,IAAX,IAAmB,OAAOA,OAAP,KAAmB,UADxC,4CAAAC,SAAS,QAEP,qCAFO,CAAT,GAAAA,SAAS,OAAT;AAKA,MAAMC,gBAAgB,GAAGC,MAAM,EAA/B;AAEAC,EAAAA,SAAS,CAAC,YAAM;AACdF,IAAAA,gBAAgB,CAACG,OAAjB,GAA2B,UAACC,KAAD,EAAW;AACpC,UAAMC,WAAW,GAAGP,OAAH,aAAGA,OAAH,uBAAGA,OAAO,CAAGM,KAAH,CAA3B,CADoC;AAGpC;;AACA,UAAI,OAAOC,WAAP,KAAuB,QAA3B,EAAqC;AACnC,eAAQD,KAAK,CAACC,WAAN,GAAoBA,WAA5B;AACD,OANmC;AAQpC;AACA;;;AACA,UAAID,KAAK,CAACE,gBAAV,EAA4B;AAC1B,eAAQF,KAAK,CAACC,WAAN,GAAoB,EAA5B;AACD;AACF,KAbD;AAcD,GAfQ,EAeN,CAACP,OAAD,CAfM,CAAT;AAiBAI,EAAAA,SAAS,CAAC,YAAM;AACd,QAAMK,aAAa,GAAG,SAAhBA,aAAgB,CAACH,KAAD;AAAA,aAAWJ,gBAAgB,CAACG,OAAjB,CAAyBC,KAAzB,CAAX;AAAA,KAAtB;;AACAI,IAAAA,MAAM,CAACC,gBAAP,CAAwB,cAAxB,EAAwCF,aAAxC;AACA,WAAO,YAAM;AACXC,MAAAA,MAAM,CAACE,mBAAP,CAA2B,cAA3B,EAA2CH,aAA3C;AACD,KAFD;AAGD,GANQ,EAMN,EANM,CAAT;AAOD;;IChCKI,YAAY,GAAG,SAAfA,YAAe,OAAyC;AAAA,2BAAtCC,QAAsC;AAAA,MAAtCA,QAAsC,8BAA3B,IAA2B;AAAA,MAArBC,cAAqB,QAArBA,cAAqB;AAC5DhB,EAAAA,eAAe,CAACgB,cAAD,CAAf;AACA,SAAOD,QAAP;AACD;;AAEDD,YAAY,CAACG;AAAU;AAAvB,0CAAgD;AAC9CF,EAAAA,QAAQ,EAAEG,SAAS,CAACC,GAD0B;AAE9CH,EAAAA,cAAc,EAAEE,SAAS,CAACE,IAAV,CAAeC;AAFe,CAAhD;;;;"}